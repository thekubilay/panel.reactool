import{a as M,C as b,c as N,M as A,q as y,f as i,w as B,x as s,F as P,E as G,t as a,D as m,W as H,B as Q,X as W,b as E,G as X,A as f}from"./vendor.js";import z from"./dropdown.esm.js";import J from"./Dialog.js";import{_ as K}from"./DialogDelete.js";import{_ as O}from"./FormQuery.js";import{i as g,a as Y}from"./rules.js";import{f as Z}from"./FormUserUpdate.js";import{A as ee,u as le}from"../main.js";import{u as ue,a as se}from"./useFormRequestBuilder.js";import ae from"./BarTool.js";import{u as oe}from"./useUtils.js";import"./overlayeventbus.esm.js";import"./virtualscroller.esm.js";import"./index3.js";import"./Spinner.js";import"./plugin-vue_export-helper.js";const q=[[{classes:["flex justify-space-between"],elements:[{component:null,name:"Dropdown",db_column_name:"is_remove_scheduled",type:"text",model:!1,label:"\u524A\u9664\u30B9\u30B1\u30B8\u30E5\u30FC\u30EB",hint:"\u4F7F\u7528\u671F\u9593\u7D42\u308F\u308B\u3068\u3001\u524A\u9664\u3057\u305F\u3044\u5834\u5408\u300C\u306F\u3044\u300D\u3092\u9078\u629E",required:!1,rules:[],id:"remove_scheduled_input",disabled:!1,options:[{name:"\u306F\u3044",value:!0},{name:"\u3044\u3044\u3048",value:!1}],optionLabel:"name",optionValue:"value",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]},{component:null,name:"CalendarInput",db_column_name:"remove_date",type:"text",model:new Date,label:"\u4F7F\u7528\u7D42\u4E86\u65E5",hint:"\u524A\u9664\u30B9\u30B1\u30B8\u30E5\u30FC\u30EB\u306F\u300C\u306F\u3044\u300D\u306E\u5834\u5408\u6642\u904B\u7528\u3055\u308C\u308B",placeholder:"",required:!1,id:"remove_date_input",rules:[],dateFormat:"yy\u5E74mm\u6708dd\u65E5",appendTo:"self",disabled:!1,props:["placeholder","required","disabled","dateFormat","appendTo"],classes:["flex-column","column-2-space"]}]},{classes:["flex justify-space-between"],elements:[{component:null,name:"Dropdown",db_column_name:"company_owner",type:"text",model:!0,label:"\u4F1A\u793E\u30AA\u30FC\u30CA\u30FC",hint:"\u5168\u3066\u306E\u30D7\u30ED\u30B8\u30A7\u30AF\u30C8\u3078\u306E\u7BA1\u7406\u6A29\u9650\u3064\u3051\u308B",required:!1,rules:[],id:"company_owner_input",disabled:!1,options:[{name:"\u306F\u3044",value:!0},{name:"\u3044\u3044\u3048",value:!1}],optionLabel:"name",optionValue:"value",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]}]},{classes:["flex justify-space-between"],elements:[{component:null,name:"MultiSelect",db_column_name:"project_roles",type:"text",model:null,label:"\u30D7\u30ED\u30B8\u30A7\u30AF\u30C8\u6A29\u9650",hint:"\u8AAD\u307F\u8FBC\u307F\u3067\u304D\u308B\u30D7\u30ED\u30B8\u30A7\u30AF\u30C8",required:!1,rules:[],id:"project_roles_input",disabled:!1,options:[],optionLabel:"name",optionValue:"id",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]}]},{classes:["flex justify-space-between"],elements:[{component:null,name:"InputText",db_column_name:"last_name",type:"text",model:null,label:"\u59D3",hint:null,placeholder:"\u7530\u4E2D",required:!0,id:"last_name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-2-space"]},{component:null,name:"InputText",db_column_name:"first_name",type:"text",model:null,label:"\u540D",hint:null,placeholder:"\u592A\u90CE",required:!0,id:"first_name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-2-space"]}]},{classes:["flex justify-space-between"],elements:[{component:null,name:"InputText",db_column_name:"username",type:"text",model:null,label:"\u30E6\u30FC\u30B6\u30FC\u540D",hint:"*\u30ED\u30B0\u30A4\u30F3\u3059\u308B\u305F\u3081\u306B\u4F7F\u308F\u308C\u307E\u3059",placeholder:"tanaka",required:!0,id:"username_input",rules:[g],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-2-space"]}]},{classes:["flex"],elements:[{component:null,name:"InputText",db_column_name:"email",type:"text",model:null,label:"\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9",hint:null,placeholder:"tanaka.tarou@reactool.jp",required:!0,id:"email_input",rules:[Y],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"InputText",db_column_name:"password",type:"text",model:null,label:"\u30D1\u30B9\u30EF\u30FC\u30C9",hint:null,placeholder:"",required:!0,id:"password_input",rules:[g],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]}]],te={id:"users",class:"admin-board"},ne={class:"part-wrap"},re={class:"part-wrap part-end"},ie={class:"spreadsheet-wrapper overflow-x"},de=H('<div class="sh-container ss-container"><div class="sheet-row sheet-row-header flex align-center"><div class="sheet-cell num flex align-center">#</div><div class="sheet-cell value flex align-center">\u30E6\u30FC\u30B6\u30FC\u540D</div><div class="sheet-cell value flex align-center">\u59D3</div><div class="sheet-cell value flex align-center">\u540D</div><div class="sheet-cell sheet-cell-long value flex align-center">\u30E1\u30FC\u30EB\u30A2\u30C9\u30EC\u30B9</div></div></div>',1),pe={class:"sb-container ss-container"},ce=["onClick"],me={class:"sheet-cell num flex align-center"},fe={class:"text block"},ve={class:"sheet-cell value flex align-center"},_e={class:"text block"},be={class:"sheet-cell value flex align-center"},he={class:"text block"},xe={class:"sheet-cell value flex align-center"},Fe={class:"text block"},Ce={class:"sheet-cell sheet-cell-long value flex align-center"},ye={class:"text block"},Be={class:"button-wrapper flex justify-end"},He=M({setup(Ee){const{get:h,save:V}=ee(),v=Q(),k=W(),{store:je,progress:De,user:we,companies:T,company:d,users:U,content:p}=le(),{findAndUpdateFormElement:j}=oe(),{d:r,dr:t,data:D,useToggle:w}=ue(),{submit:$,remove:I}=se(),o=b(q),x=b(!1),F=b(null),_=b([]),C=N({set(u){p.value=!0,k.push({params:{cid:u}}),h("companies/"+u,"company").then(()=>{p.value=!1})},get(){var u;return(u=d.value)==null?void 0:u.id}});function L(){var u;x.value=!1,o.value=q,o.value[0][0].elements[1].model=new Date,o.value=j(o.value,"project_roles","options",(u=d.value)==null?void 0:u.projects),w({method:"post",endpoints:["users","companies/"+v.params.cid],state:"company"})}function S(u){var e;_.value=u.project_roles,x.value=!0,o.value=Z,o.value=j(o.value,"project_roles","options",(e=d.value)==null?void 0:e.projects),w({method:"patch",endpoints:["users/"+u.id,"companies/"+v.params.cid],state:"company"},u)}function R(){var u;p.value=!0,I("users/"+((u=D.value)==null?void 0:u.id)).then(()=>{h("companies/"+v.params.cid,"company").then(()=>{t.value=!1,r.value=!1,p.value=!1})})}return A(()=>o.value[0][2].elements[0].model,u=>{_.value=u}),A(F,u=>{var e,l;if(u){let c=(l=(e=d.value)==null?void 0:e.projects)==null?void 0:l.map(n=>{if(!_.value.includes(n.id))return n.id});c=c.filter(n=>n),V("roles",{user:u.id,create:_.value,remove:c}).then(()=>{var n;h("companies/"+((n=d.value)==null?void 0:n.id),"company").then(()=>{p.value=!1})})}}),(u,e)=>(E(),y("div",te,[i(ae,{class:"justify-space-between"},{default:B(()=>[s("div",ne,[i(a(X),{type:"button",class:"submit-button",icon:"pi pi-plus","icon-pos":"left",label:"\u65B0\u898F\u30E6\u30FC\u30B6\u30FC",onClick:e[0]||(e[0]=l=>L())})]),s("div",re,[i(a(z),{style:{width:"140px"},class:"dropdown",modelValue:a(C),"onUpdate:modelValue":e[1]||(e[1]=l=>m(C)?C.value=l:null),"option-label":"name","option-value":"id",options:a(T)},null,8,["modelValue","options"])])]),_:1}),s("div",ie,[de,s("div",pe,[(E(!0),y(P,null,G(a(U),(l,c)=>(E(),y("div",{key:l.id,onClick:n=>S(l),class:"sheet-row flex align-center relative pointer"},[s("div",me,[s("span",fe,f(c+1),1)]),s("div",ve,[s("span",_e,f(l.username),1)]),s("div",be,[s("span",he,f(l.last_name),1)]),s("div",xe,[s("span",Fe,f(l.first_name),1)]),s("div",Ce,[s("span",ye,f(l.email),1)])],8,ce))),128))])]),i(J,{modelValue:a(r),"onUpdate:modelValue":e[9]||(e[9]=l=>m(r)?r.value=l:null),title:"\u30E6\u30FC\u30B6\u30FC\u30D5\u30A9\u30FC\u30E0",overflow:""},{default:B(()=>[i(O,{modelValue:a(r),"onUpdate:modelValue":e[2]||(e[2]=l=>m(r)?r.value=l:null),dr:a(t),"onUpdate:dr":e[3]||(e[3]=l=>m(t)?t.value=l:null),form:o.value,"onUpdate:form":e[4]||(e[4]=l=>o.value=l),response:F.value,"onUpdate:response":e[5]||(e[5]=l=>F.value=l),"close-after":"",query:{company:a(v).params.cid},data:a(D),remove:x.value,submit:a($)},null,8,["modelValue","dr","form","response","query","data","remove","submit"]),i(K,{modelValue:a(t),"onUpdate:modelValue":e[8]||(e[8]=l=>m(t)?t.value=l:null)},{default:B(()=>[s("div",Be,[s("button",{onClick:e[6]||(e[6]=l=>t.value=!1),class:"cancel"},"\u3044\u3044\u3048"),s("button",{onClick:e[7]||(e[7]=l=>R()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}});export{He as default};
