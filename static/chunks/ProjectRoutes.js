import{D as z}from"./vuedraggable.umd.js";import{d as N,A as H,u as I,r as m,a as L,w as O,c as x,b as i,f as a,z as v,q as _,e as l,a1 as M,o as b,L as T,t as d}from"../main.js";import{s as G}from"./menu.esm.js";import{_ as J}from"./Dialog.js";import{_ as K}from"./FormQuery.js";import{_ as Q}from"./DialogDelete.js";import{S as W}from"./Spinner.js";import{_ as X}from"./BarTool.js";import{f as Y}from"./FormRoute.js";import{u as Z,a as ee}from"./useFormRequestBuilder.js";import{u as te}from"./useRightClickHandler.js";import"./_commonjsHelpers.js";import"./portal.esm.js";import"./plugin-vue_export-helper.js";import"./rules.js";const le={id:"project_routes",class:"relative panel-board"},se={class:"part-wrap"},ae={class:"spreadsheet-wrapper overflow-x"},oe=M('<div class="sh-container ss-container"><div class="sheet-row sheet-row-header flex align-center"><div class="sheet-cell handle flex align-center"></div><div class="sheet-cell num flex align-center">\u9806\u756A</div><div class="sheet-cell value flex align-center">\u30B3\u30F3\u30DD\u30FC\u30CD\u30F3\u30C8</div><div class="sheet-cell value flex align-center">\u30CD\u30FC\u30E0</div><div class="sheet-cell value flex align-center">\u30D1\u30CD\u30EB\u30CD\u30FC\u30E0</div><div class="sheet-cell value flex align-center">\u30BF\u30A4\u30C8\u30EB</div><div class="sheet-cell value flex align-center">URL\u30D1\u30B9</div><div class="sheet-cell value flex align-center">\u30A2\u30AF\u30C6\u30A3\u30D6</div></div></div>',1),ne=["onClick","onContextmenu"],ue=l("div",{class:"sheet-cell handle flex align-center handle grab"},[l("i",{class:"pi pi-bars"})],-1),ie={class:"sheet-cell num flex align-center"},re={class:"text block"},ce={class:"sheet-cell sheet-cell value flex align-center"},de={class:"text block"},pe={class:"sheet-cell value flex align-center"},ve={class:"text block"},me={class:"sheet-cell value flex align-center"},_e={class:"text block"},fe={class:"sheet-cell value flex align-center"},he={class:"text block"},ge={class:"sheet-cell value flex align-center"},xe={class:"text block"},be={class:"sheet-cell value flex align-center"},Ce={class:"context block"},je={key:0,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#2ecc71"}},ke={key:1,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#e74c3c"}},Be={class:"button-wrapper flex justify-end"},Oe=N({__name:"ProjectRoutes",setup(De){var k,B;const{get:f,save:y}=H(),{submit:F,submitRowReorder:V,remove:C}=Z(),{d:r,dr:u,data:n,useToggle:h}=ee(),{rcm:w,rcmOpened:ye,isRCOn:A}=te(n),{payload:Fe,content:c,progress:$,project:o}=I(),g=m(!1),j=m(!1),p=m(((k=o.value)==null?void 0:k.routes)||[]),E=L({id:null,project:((B=o.value)==null?void 0:B.id)||null,order_id:null,component:null,name:null,panel_name:null,path:null,title:null,active:!1});function R(){var s;g.value=!1,h({method:"post",endpoints:["app/routes","project_details/"+((s=o.value)==null?void 0:s.id)],state:"project"})}function U(s){var e;g.value=!0,h({method:"patch",endpoints:["app/routes/"+s.id,"project_details/"+((e=o.value)==null?void 0:e.id)],state:"project"},s)}function S(){var s;j.value=!0,C("app/routes/"+((s=n.value)==null?void 0:s.id)).then(()=>{var e;u.value=!1,f("project_details/"+((e=o.value)==null?void 0:e.id),"project").then(()=>{r.value=!1,j.value=!1})})}const q=m([{label:"\u65B0\u898F\u30EB\u30FC\u30C8",command:()=>{var s;h({method:"post",endpoints:["app/routes","project_details/"+((s=o.value)==null?void 0:s.id)],state:"project"})}},{label:"\u884C\u3092\u8907\u88FD\u3059\u308B",command:()=>{var e;c.value=!0;const s={order_id:p.value?p.value.length+1:1,project:((e=o.value)==null?void 0:e.id)||null,component:n.value.component,name:n.value.name,path:n.value.path,title:n.value.title,active:n.value.active};y("app/routes",s).then(()=>{var t;f("project_details/"+((t=o.value)==null?void 0:t.id),"project").then(()=>{c.value=!1})})}},{label:"\u884C\u3092\u524A\u9664\u3059\u308B",command:()=>{var s;c.value=!0,C("app/routes/"+((s=n.value)==null?void 0:s.id)).then(()=>{var e;f("project_details/"+((e=o.value)==null?void 0:e.id),"project").then(()=>{c.value=!1})})}}]);return O(()=>o.value,s=>{p.value=(s==null?void 0:s.routes)||[]}),(s,e)=>(b(),x("div",le,[i(W,{modelValue:a(c),"onUpdate:modelValue":e[0]||(e[0]=t=>v(c)?c.value=t:null)},null,8,["modelValue"]),i(X,{class:"justify-space-between"},{default:_(()=>[l("div",se,[i(a(T),{type:"button",class:"submit-button",icon:"pi pi-plus","icon-pos":"left",label:"\u65B0\u898F\u65BD\u8A2D",onClick:e[1]||(e[1]=t=>R())})])]),_:1}),l("div",ae,[oe,i(a(z),{tag:"div",onEnd:e[2]||(e[2]=t=>a(V)({value:p.value},{method:"post",endpoints:["app/routes","project_details/"+a(o).id],state:"project"})),list:p.value,class:"sb-container ss-container",handle:".handle","item-key":"id"},{item:_(({element:t,index:P})=>[l("div",{onClick:D=>U(t),onContextmenu:D=>a(A)(D,t),"aria-haspopup":"true","aria-controls":"plan_rc_menu",class:"sheet-row flex align-center list-group-item relative pointer"},[i(a(G),{id:"rc_menu",ref_key:"rcm",ref:w,class:"rc has-final-action",model:q.value,popup:!0},null,8,["model"]),ue,l("div",ie,[l("span",re,d(P+1),1)]),l("div",ce,[l("span",de,d(t.component),1)]),l("div",pe,[l("span",ve,d(t.name),1)]),l("div",me,[l("span",_e,d(t.panel_name),1)]),l("div",fe,[l("span",he,d(t.title),1)]),l("div",ge,[l("span",xe,d(t.path),1)]),l("div",be,[l("span",Ce,[t.active?(b(),x("i",je)):(b(),x("i",ke))])])],40,ne)]),_:1},8,["list"])]),i(J,{modelValue:a(r),"onUpdate:modelValue":e[8]||(e[8]=t=>v(r)?r.value=t:null),title:"\u30EB\u30FC\u30C8\u30D5\u30A9\u30FC\u30E0"},{default:_(()=>[i(K,{modelValue:a(r),"onUpdate:modelValue":e[3]||(e[3]=t=>v(r)?r.value=t:null),dr:a(u),"onUpdate:dr":e[4]||(e[4]=t=>v(u)?u.value=t:null),"close-after":"",topProgress:"",progress:a($),form:a(Y),data:a(n),remove:g.value,query:E,submit:a(F)},null,8,["modelValue","dr","progress","form","data","remove","query","submit"]),i(Q,{modelValue:a(u),"onUpdate:modelValue":e[7]||(e[7]=t=>v(u)?u.value=t:null)},{default:_(()=>[l("div",Be,[l("button",{onClick:e[5]||(e[5]=t=>u.value=!1),class:"cancel"},"\u3044\u3044\u3048"),l("button",{onClick:e[6]||(e[6]=t=>S()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}});export{Oe as default};
