import{r as h,_ as c,E as _,G as Z,H as ee,o as l,c as d,I as U,d as q,b as I,q as Q,T as te,F as V,s as D,f as S,J as M,C as ne,K as ae,A as re,m as z,l as oe,B as se,L as le,w as E,g as k,n as $,t as A,e as B,i as ie,y as ue,D as de,h as fe}from"../main.js";import{S as pe}from"./Spinner.js";import{_ as me}from"./plugin-vue_export-helper.js";function ce(){const o=h([]),f=h(null);function t(e){return new Date(e).toISOString().substring(0,10)}function a(e,n){return e==="start_date"||e==="end_date"?t(n):n}return{reform:o,requery:f,setProps:e=>e.props.reduce((n,y)=>(n[y]=e[y],n),{}),setFormQueryValues:(e,n,y)=>new Promise(b=>{f.value=n,o.value=e.filter((w,x)=>x===y),e.forEach(w=>{w.forEach(x=>{x.elements.forEach(T=>{f.value[T.db_column_name]=a(T.db_column_name,T.model)})})}),b(!0)})}}function _e(){return{setFormDefaultData:(t,a)=>{a&&t.forEach(p=>{p.forEach(i=>{i.elements.forEach(e=>{e.name==="Dropdown"&&typeof e.model=="boolean"?e.model=a[e.db_column_name]:e.name==="Dropdown"&&typeof e.model!="boolean"?a[e.db_column_name]?e.model=a[e.db_column_name]:e.model=null:e.name==="InputNumber"||e.name==="SliderInput"?e.model=a[e.db_column_name]?parseInt(a[e.db_column_name]):null:e.name==="FileInput"||(e.model=a[e.db_column_name])})})})},setClear:t=>(t.forEach(a=>{a.forEach(p=>{p.elements.forEach(i=>{i.name==="Dropdown"&&typeof i.model=="boolean"?i.db_column_name==="sub"?i.model=!1:i.model=!0:i.name==="Dropdown"&&typeof i.model!="boolean"||i.name!=="Dropdown"&&(i.model=null)})})}),t)}}function ve(){return{setDynamics:f=>{let t=0;return new Promise((a,p)=>{f[0].length?f[0].forEach(i=>{i.elements.forEach(e=>{e.name==="InputText"&&c(()=>import("../main.js").then(function(n){return n.b_}),["main.js","assets/main2.css"]).then(n=>{e.component=_(n.default)}),e.name==="InputNumber"&&c(()=>import("../main.js").then(function(n){return n.b$}),["main.js","assets/main2.css"]).then(n=>{e.component=_(n.default)}),e.name==="Dropdown"&&c(()=>import("./dropdown.esm.js").then(function(n){return n.d}),["chunks/dropdown.esm.js","main.js","assets/main2.css","chunks/index.esm.js","chunks/virtualscroller.esm.js","chunks/portal.esm.js"]).then(n=>{e.component=_(n.default)}),e.name==="MultiSelect"&&c(()=>import("./multiselect.esm.js"),["chunks/multiselect.esm.js","main.js","assets/main2.css","chunks/index.esm3.js","chunks/index.esm.js","chunks/virtualscroller.esm.js","chunks/portal.esm.js"]).then(n=>{e.component=_(n.default)}),e.name==="Checkbox"&&c(()=>import("./checkbox.esm.js"),["chunks/checkbox.esm.js","chunks/index.esm3.js","main.js","assets/main2.css"]).then(n=>{e.component=_(n.default)}),e.name==="Password"&&c(()=>import("./password.esm.js"),["chunks/password.esm.js","main.js","assets/main2.css","chunks/portal.esm.js"]).then(n=>{e.component=_(n.default)}),e.name==="Textarea"&&c(()=>import("./textarea.esm.js"),["chunks/textarea.esm.js","main.js","assets/main2.css"]).then(n=>{e.component=_(n.default)}),e.name==="RadioButton"&&c(()=>import("./radiobutton.esm.js"),["chunks/radiobutton.esm.js","main.js","assets/main2.css"]).then(n=>{e.component=_(n.default)}),e.name==="FileInput"&&c(()=>import("./FileInput.js"),["chunks/FileInput.js","assets/FileInput.css","chunks/Icon.js","main.js","assets/main2.css"]).then(n=>{e.component=_(n.default)}),e.name==="SliderInput"&&c(()=>import("./slider.esm.js"),["chunks/slider.esm.js","main.js","assets/main2.css"]).then(n=>{e.component=_(n.default)}),e.name==="CalendarInput"&&c(()=>import("./calendar.esm.js"),["chunks/calendar.esm.js","main.js","assets/main2.css","chunks/index.esm.js","chunks/index.esm2.js","chunks/portal.esm.js"]).then(n=>{e.component=_(n.default)})}),t+=1,t===f.length&&a(!0)}):a(!0)})}}}function he(){return{isElementValid:t=>{let a={valid:!0,errors:[]};return t.model&&t.required&&(t.rules.forEach(p=>{a.errors.push(p(t.model))}),a.errors=a.errors.filter(p=>p!==""),a.errors=[...new Set(a.errors)]),a.valid=!t.required||t.model!==""||typeof t.model=="number",a},isFormValid:t=>{let a=[];return t.forEach(p=>{p.forEach(i=>{i.elements.forEach(e=>{if(e.required&&!e.model&&typeof e.model!="boolean"&&e.id){const n=document.getElementById(e.id);n.classList.add("error"),a.push(n)}})})}),!a.length}}}var ye=`
.p-skeleton {
    overflow: hidden;
}

.p-skeleton::after {
    content: '';
    animation: p-skeleton-animation 1.2s infinite;
    height: 100%;
    left: 0;
    position: absolute;
    right: 0;
    top: 0;
    transform: translateX(-100%);
    z-index: 1;
}

.p-skeleton.p-skeleton-circle {
    border-radius: 50%;
}

.p-skeleton-none::after {
    animation: none;
}

@keyframes p-skeleton-animation {
    from {
        transform: translateX(-100%);
    }
    to {
        transform: translateX(100%);
    }
}
`,be={root:{position:"relative"}},ge={root:function(f){var t=f.props;return["p-skeleton p-component",{"p-skeleton-circle":t.shape==="circle","p-skeleton-none":t.animation==="none"}]}},Ee=Z(ye,{name:"skeleton",manual:!0}),ke=Ee.load,Ve={name:"BaseSkeleton",extends:ee,props:{shape:{type:String,default:"rectangle"},size:{type:String,default:null},width:{type:String,default:"100%"},height:{type:String,default:"1rem"},borderRadius:{type:String,default:null},animation:{type:String,default:"wave"}},css:{classes:ge,inlineStyles:be,loadStyle:ke},provide:function(){return{$parentInstance:this}}},L={name:"Skeleton",extends:Ve,computed:{containerStyle:function(){return this.size?{width:this.size,height:this.size,borderRadius:this.borderRadius}:{width:this.width,height:this.height,borderRadius:this.borderRadius}}}};function De(o,f,t,a,p,i){return l(),d("div",U({class:o.cx("root"),style:[o.sx("root"),i.containerStyle],"aria-hidden":"true"},o.ptm("root"),{"data-pc-name":"skeleton"}),null,16)}L.render=De;const Se={class:"skeleton-wrapper"},Ie={key:0,class:"skeleton-window absolute"},we=q({__name:"DefaultSkeleton",props:{modelValue:Boolean},setup(o){const f=h("fade"),t=h(2);return(a,p)=>(l(),d("div",Se,[I(te,{name:f.value},{default:Q(()=>[o.modelValue?M(a.$slots,"default",{key:1},void 0,!0):(l(),d("div",Ie,[(l(!0),d(V,null,D(t.value,i=>(l(),d("div",{key:i,class:"skeleton-scaffold"},[I(S(L),{height:"19px",width:"100px",class:"skeleton"}),I(S(L),{height:"36px",width:"100%",class:"skeleton"})]))),128))]))]),_:3},8,["name"])]))}});var xe=me(we,[["__scopeId","data-v-125e0694"]]);const Te=q({__name:"TopEdgeProgress",props:{modelValue:Number},setup(o){return(f,t)=>(l(),d("div",{class:"top-edge-progress",style:ne({width:o.modelValue+"%"})},null,4))}}),Pe={ref:"container",id:"form"},Fe={key:0,class:"tabs flex align-center"},Ae=["onClick"],Be=["onSubmit"],Ce={key:0,class:"label title-label"},Re={class:"label flex"},Oe={key:0,class:"required flex align-start"},$e={key:1,class:"hint"},Le={class:"action-wrapper flex align-center"},ze=q({__name:"FormQuery",props:{modelValue:Boolean,display:Boolean,dr:Boolean,remove:Boolean,selectedId:Number,activeTab:{type:Number,default:0},form:{type:Array,default:[]},data:Object,loading:{type:Boolean,default:!1},progress:Number,onload:{type:String,default:""},query:Object,nestedQuery:Object,closeAfter:Boolean,tabs:{type:Array,default:[]},submit:Function},emits:["update:modelValue","update:dr","update:response","update:payload","update:activeTab","update:form"],setup(o,{emit:f}){const t=o;ae();const{setDynamics:a}=ve(),{setFormDefaultData:p,setClear:i}=_e(),{reform:e,requery:n,setProps:y,setFormQueryValues:b}=ce(),{isElementValid:w,isFormValid:x}=he(),{get:T}=re(),C=h(!1),g=h(!1),v=h(0),j=z(()=>t.progress),N=z(()=>t.loading);oe(()=>{se(),v.value=t.activeTab,document.addEventListener("keydown",R),t.activeTab===0&&b(t.form,t.query,v.value).then(()=>{a(e.value.filter((r,s)=>s===v.value)).then(r=>{p(e.value,t.data),g.value=r})})}),le(()=>{document.removeEventListener("keydown",R),i(e.value)});const X=r=>{v.value=r,t.tabs&&f("update:activeTab",r)},H=r=>{C.value=!1,r&&f("update:response",r),t.closeAfter&&setTimeout(()=>{f("update:modelValue",!1)},300)},G=()=>{e.value.forEach(r=>{r.forEach(s=>{s.elements.forEach(u=>{u.model=u.name!=="FileInput"?u.model:null})})})},J=()=>{f("update:dr",!0)},R=(r,s=!1)=>{(s||r.keyCode===13)&&(document.getElementById("tpb").style.opacity="1",r.preventDefault(),C.value=!0,x(e.value)?t.submit(n.value,e.value).then(u=>{G(),H(u)}):(T("project/"+t.query.project_id+"/","project"),C.value=!1))};return E(()=>t.query,r=>{b(t.form,r,v.value)}),E(()=>t.loading,r=>{C.value=r}),E(()=>t.activeTab,r=>{v.value=r}),E(()=>t.data,r=>{p(e.value,r)}),E(()=>t.form,r=>{e.value=r,b(e.value,t.query,v.value).then(()=>{a(e.value.filter((s,u)=>u===v.value)).then(s=>{g.value=s})})}),E(()=>v.value,r=>{g.value=!1,b(t.form,t.query,r).then(()=>{a(e.value).then(s=>{p(e.value,t.data),g.value=s})})}),(r,s)=>(l(),d("div",Pe,[I(pe,{modelValue:N.value,"onUpdate:modelValue":s[0]||(s[0]=u=>N.value=u),text:o.onload?o.onload:null},null,8,["modelValue","text"]),I(Te,{id:"tpb",modelValue:j.value,"onUpdate:modelValue":s[1]||(s[1]=u=>j.value=u)},null,8,["modelValue"]),o.tabs.length?(l(),d("div",Fe,[(l(!0),d(V,null,D(o.tabs,(u,P)=>(l(),d("button",{key:P,onClick:F=>X(P),class:$([{active:P===v.value},"tab flex align-center justify-center"])},A(u),11,Ae))),128))])):k("",!0),I(xe,{modelValue:g.value,"onUpdate:modelValue":s[5]||(s[5]=u=>g.value=u)},{default:Q(()=>[B("form",{action:"",onSubmit:fe(u=>!1,["prevent"])},[(l(!0),d(V,null,D(S(e),(u,P)=>(l(),d("div",{key:P},[(l(!0),d(V,null,D(u,(F,K)=>(l(),d("div",{key:K,class:$(["row",F.classes])},[F.elements[0].hasOwnProperty("title")?(l(),d("span",Ce,A(F.elements[0].title),1)):k("",!0),(l(!0),d(V,null,D(F.elements,(m,W)=>(l(),d("div",{key:W,class:$(m.classes)},[B("span",Re,[ie(A(m.label),1),m.required?(l(),d("span",Oe,"*\u5FC5\u9808")):k("",!0)]),m.component?(l(),ue(de(m.component),U({key:0,id:m.id},S(y)(m),{modelValue:m.model,"onUpdate:modelValue":O=>m.model=O,class:["cfec column-1",{error:!S(w)(m).valid}]}),null,16,["id","modelValue","onUpdate:modelValue","class"])):k("",!0),(l(!0),d(V,null,D(S(w)(m).errors,(O,Y)=>(l(),d("span",{key:Y,class:"invalid block"},"*"+A(O),1))),128)),m.hint&&m.name!=="FileInput"?(l(),d("span",$e,A(m.hint),1)):k("",!0)],2))),128))],2))),128)),M(r.$slots,"default")]))),128)),B("div",Le,[B("button",{onClick:s[2]||(s[2]=u=>f("update:modelValue",!1)),class:"flex align-center justify-center cancel"},"\u4E2D\u6B62"),o.remove?(l(),d("button",{key:0,onClick:s[3]||(s[3]=u=>J()),class:"flex align-center justify-center remove"},"\u524A\u9664 ")):k("",!0),B("button",{onClick:s[4]||(s[4]=u=>R(u,!0)),class:"flex align-center justify-center submit-or-next"},"\u767B\u9332 ")])],40,Be)]),_:3},8,["modelValue"])],512))}});export{xe as D,ze as _,Te as a,ve as b,_e as c,he as d,ce as u};
