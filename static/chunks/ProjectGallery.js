import{d as V}from"./vuedraggable.umd.js";import{d as A,D as f,F as D,b as R,k as u,u as l,l as d,w as p,e as a,a3 as $,a as q,U as I,t as m}from"./vendor.js";import{s as S}from"./menu.esm.js";import{u as N,a as U,S as H,_ as P}from"./useFormRequestBuilder.js";import{_ as M}from"./BarTool.js";import{_ as O}from"./Icon.js";import{A as T,u as G}from"../main.js";import{u as Q}from"./useRightClickHandler.js";import{_ as z}from"./FormQuery.js";import{c as J,d as K}from"./rules.js";import"./overlayeventbus.esm.js";const L=[[{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"image",type:"text",model:null,label:"\u753B\u50CF",hint:".jpeg, .png \u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!0,id:"gallery_image_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[J],rule:K,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]}]];const W={id:"project_gallery",class:"panel-board relative"},X={class:"part-wrap"},Y={class:"spreadsheet-wrapper overflow-x"},Z=$('<div class="sh-container ss-container"><div class="sheet-row sheet-row-header flex align-center"><div class="sheet-cell handle flex align-center"></div><div class="sheet-cell num flex align-center">\u9806\u756A</div><div class="sheet-cell value sheet-cell-long flex align-center">\u753B\u50CF\u540D</div><div class="sheet-cell value flex align-center">\u30BF\u30A4\u30D7</div></div></div>',1),ee=["onContextmenu","onClick"],se=a("div",{class:"sheet-cell handle flex align-center handle grab"},[a("i",{class:"pi pi-bars"})],-1),le={class:"sheet-cell num flex align-center"},te={class:"text block"},ae={class:"sheet-cell value sheet-cell-long flex align-center"},oe={class:"text block",style:{"padding-bottom":"2px",width:"calc(100% - 30px)","margin-left":"5px"}},ue={class:"sheet-cell value flex align-center"},ie={class:"text block"},Fe=A({setup(ne){var v;const{get:h,save:re}=T(),{submit:x,submitRowReorder:C,remove:b}=N(),{d:i,dr:ce,data:_,useToggle:r}=U(),{rcm:j,rcmOpened:de,isRCOn:y}=Q(_),{payload:pe,content:n,progress:F,project:o}=G(),c=f(((v=o.value)==null?void 0:v.gallery)||[]);function B(){var s;r({method:"post",endpoints:["app/galleries","project_details/"+((s=o.value)==null?void 0:s.id)],state:"project"})}function E(s){var e;r({method:"patch",endpoints:["app/galleries/"+s.id,"project_details/"+((e=o.value)==null?void 0:e.id)],state:"project"})}const k=f([{label:"\u65B0\u898F\u753B\u50CF",command:()=>{var s;r({method:"post",endpoints:["app/galleries","project_details/"+((s=o.value)==null?void 0:s.id)],state:"project"})}},{label:"\u884C\u3092\u524A\u9664\u3059\u308B",command:()=>{var s;n.value=!0,b("app/galleries/"+((s=_.value)==null?void 0:s.id)).then(()=>{var e;h("project_details/"+((e=o.value)==null?void 0:e.id),"project").then(()=>{n.value=!1})})}}]);return D(()=>o.value,s=>{c.value=(s==null?void 0:s.gallery)||[]}),(s,e)=>(q(),R("div",W,[u(H,{modelValue:l(n),"onUpdate:modelValue":e[0]||(e[0]=t=>d(n)?n.value=t:null)},null,8,["modelValue"]),u(M,{class:"justify-space-between"},{default:p(()=>[a("div",X,[u(l(I),{type:"button",class:"submit-button",icon:"pi pi-plus","icon-pos":"left",label:"\u65B0\u898F\u753B\u50CF",onClick:e[1]||(e[1]=t=>B())})])]),_:1}),a("div",Y,[Z,u(l(V),{tag:"div",onEnd:e[2]||(e[2]=t=>l(C)({value:c.value},{method:"post",endpoints:["app/galleries","project_details/"+l(o).id],state:"project"})),list:c.value,class:"sb-container ss-container",handle:".handle","item-key":"id"},{item:p(({element:t,index:w})=>[a("div",{onContextmenu:g=>l(y)(g,t),onClick:g=>E(t),"aria-haspopup":"true","aria-controls":"plan_rc_menu",class:"sheet-row flex align-center list-group-item relative pointer"},[u(l(S),{id:"rc_menu",ref_key:"rcm",ref:j,class:"rc has-final-action",model:k.value,popup:!0},null,8,["model"]),se,a("div",le,[a("span",te,m(w+1),1)]),a("div",ae,[u(O,{svg:"image"}),a("span",oe,m(t.image.split("/",6)[5].split(".")[0]),1)]),a("div",ue,[a("span",ie,m(t.type),1)])],40,ee)]),_:1},8,["list"])]),u(P,{modelValue:l(i),"onUpdate:modelValue":e[4]||(e[4]=t=>d(i)?i.value=t:null),title:"\u30AE\u30E3\u30E9\u30EA\u30FC\u30D5\u30A9\u30FC\u30E0"},{default:p(()=>[u(z,{modelValue:l(i),"onUpdate:modelValue":e[3]||(e[3]=t=>d(i)?i.value=t:null),"close-after":"",topProgress:"",progress:l(F),form:l(L),query:{project:l(o).id},submit:l(x)},null,8,["modelValue","progress","form","query","submit"])]),_:1},8,["modelValue"])]))}});export{Fe as default};
