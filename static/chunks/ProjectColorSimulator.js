import{p as v,c as ce,a as J,b as j,v as U,e as M,w as f,x as t,f as r,z as o,A as O,K as W,y as X,H as b,a3 as _e,o as ve,t as Y,R as Z,F as fe,G as he}from"./vendor.js";import{D as ee}from"./vuedraggable.umd.js";import Ce from"./dropdown.esm.js";import{s as le}from"./menu.esm.js";import{s as be,a as oe}from"./column.esm.js";import{u as ue,a as te,_ as H,S as ge}from"./useFormRequestBuilder.js";import{_ as Ee}from"./BarTool.js";import{_ as ae}from"./FormQuery.js";import{_ as xe}from"./ContextImagesThumbnailContainer.js";import{A as se,u as re}from"../main.js";import{u as ne}from"./useRightClickHandler.js";import{_ as ie}from"./DialogDelete.js";import{_ as Fe}from"./FormNested.js";import{_ as me}from"./Icon.js";import{u as je}from"./useUtils.js";import"./overlayeventbus.esm.js";import"./virtualscroller.esm.js";import"./plugin-vue_export-helper.js";const G=[[{classes:["flex"],elements:[{component:null,name:"InputText",db_column_name:"name",type:"text",model:null,label:"\u30EB\u30FC\u30E0\u540D",hint:null,placeholder:"\u30EA\u30D3\u30F3\u30B0",required:!0,id:"name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"image",type:"text",model:null,label:"BASE\u753B\u50CF",hint:".jpeg, .png \u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!1,id:"room_image_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[],rule:null,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]}]],de=[[{classes:["flex","justify-space-between"],elements:[{component:null,name:"InputText",db_column_name:"name",type:"text",model:null,label:"PART\u540D",hint:null,placeholder:"\u5E8A",required:!0,id:"part_name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-2-space"]},{component:null,name:"InputNumber",db_column_name:"column_count",type:"text",model:4,label:"\u30AB\u30FC\u30C9\u6570",hint:"\u4E00\u884C\u306B\u4E26\u3073\u305F\u3044\u30AB\u30E9\u30FC\u30AB\u30FC\u30C9\u6570",placeholder:"4",required:!0,id:"column_count_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-2-space"]}]}]];function ye(){const{get:D,save:x}=se(),{submit:h,submitRowReorder:T,remove:g}=ue(),{d:V,d2:d,dr:p,data:F,images:y,useToggle:B}=te(),{rcm:k,rcmOpened:A,isRCOn:L}=ne(F),{payload:$,content:R,progress:w,project:n}=re(),m=v(!1),C=v(!1),E=v(null),c=v(G),q=v([]),S=v(null),_=v(),N=v([{icon:"pi pi-plus",label:"\u30EB\u30FC\u30E0\u3092\u8FFD\u52A0",command:()=>{var a,s;m.value=!1,E.value={project:((a=n.value)==null?void 0:a.id)||null},y.value=[],c.value=G,B({method:"post",endpoints:["app/color_simulator_rooms","project_details/"+((s=n.value)==null?void 0:s.id)],state:"project"})}},{icon:"pi pi-pencil",label:"\u30EB\u30FC\u30E0\u7DE8\u96C6",command:()=>{var a,s,I,z,Q;m.value=!0,E.value={project:((a=n.value)==null?void 0:a.id)||null},c.value=G,y.value=((s=_.value)==null?void 0:s.image)?[{image:(I=_.value)==null?void 0:I.image}]:[],B({method:"patch",endpoints:["app/color_simulator_rooms/"+((z=_.value)==null?void 0:z.id),"project_details/"+((Q=n.value)==null?void 0:Q.id)],state:"project"},_.value)}},{icon:"pi pi-bars",label:"\u30EB\u30FC\u30E0\u306E\u4E26\u3073\u66FF\u3048",command:()=>{var a;m.value=!1,c.value=[[]],y.value=[],$.value={method:"post",endpoints:["app/color_simulator_rooms","project_details/"+((a=n.value)==null?void 0:a.id)],state:"project"},d.value=!0}},{icon:"pi pi-plus",label:"\u30EB\u30FC\u30E0\u30D1\u30FC\u30C4\u3092\u8FFD\u52A0",command:()=>{var a,s;y.value=[],m.value=!1,E.value={color_simulator_room:(a=_.value)==null?void 0:a.id},c.value=de,$.value={method:"post",endpoints:["app/color_simulator_room_parts","project_details/"+((s=n.value)==null?void 0:s.id)],state:"project"},V.value=!0}}]),i=ce(()=>{var a,s;return((a=_.value)==null?void 0:a.room_parts.length)>1?"column-"+((s=_.value)==null?void 0:s.room_parts.length)+"-space":"column-2-space"});return{d:V,d2:d,data:F,dr:p,rm:m,reform:c,query:E,loading:C,images:y,column:i,content:R,project:n,dropdownItems:N,rcm:k,rooms:q,room:_,roomId:S,isRCOn:L,rowReorder:a=>{q.value=a.value},sro:()=>{var a;C.value=!0,$.value={method:"post",endpoints:["app/color_simulator_rooms","project_details/"+((a=n.value)==null?void 0:a.id)],state:"project"},h({reordered:q.value},null,"object").then(()=>{C.value=!1,d.value=!1})},open:a=>{var s,I;E.value={color_simulator_room:(s=_.value)==null?void 0:s.id},c.value=de,m.value=!0,B({method:"patch",endpoints:["app/color_simulator_room_parts/"+a.id,"project_details/"+((I=n.value)==null?void 0:I.id)],state:"project"},a)},removeItem:()=>{var s,I;C.value=!0;const a=((s=E.value)==null?void 0:s.hasOwnProperty("project"))?"app/color_simulator_rooms/":"app/color_simulator_room_parts/";g(a+((I=F.value)==null?void 0:I.id)).then(()=>{var z;p.value=!1,D("project_details/"+((z=n.value)==null?void 0:z.id),"project").then(()=>{V.value=!1,C.value=!1})})},removeImage:a=>{var s;C.value=!0,$.value={method:"patch",endpoints:["app/color_simulator_rooms/"+F.value.id,"project_details/"+((s=n.value)==null?void 0:s.id)],state:"project"},h({image:null,thumbnail:null},null,"object").then(()=>{C.value=!1,y.value=[]})},submit:h,submitRowReorder:T}}const pe=[[{classes:["flex","justify-space-between"],elements:[{component:null,name:"Dropdown",db_column_name:"option",type:"text",model:!1,label:"\u5225\u58F2\u54C1",hint:null,required:!0,rules:[],id:"option_input",disabled:!1,options:[{name:"\u306F\u3044",value:!0},{name:"\u3044\u3044\u3048",value:!1}],optionLabel:"name",optionValue:"value",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]},{component:null,name:"Dropdown",db_column_name:"model_room",type:"text",model:!1,label:"\u30E2\u30C7\u30EB\u30EB\u30FC\u30E0",hint:null,required:!0,rules:[],id:"model_room_input",disabled:!1,options:[{name:"\u306F\u3044",value:!0},{name:"\u3044\u3044\u3048",value:!1}],optionLabel:"name",optionValue:"value",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]}]},{classes:["flex"],elements:[{component:null,name:"InputText",db_column_name:"color",type:"text",model:null,label:"\u30AB\u30E9\u30FC\u30A2\u30A4\u30C6\u30E0\u540D",hint:null,placeholder:"\u30FC",required:!0,id:"name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"part_image",type:"text",model:null,label:"\u30D1\u30FC\u30C4\u753B\u50CF",hint:".png \u304C\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!1,id:"part_image_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[],rule:null,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"color_image",type:"text",model:null,label:"\u30AB\u30E9\u30FC\u753B\u50CF",hint:".png \u3068 .jpeg \u304C\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!1,id:"color_image_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[],rule:null,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]}]];const Be={class:"room-part-items-wrapper"},Ae=_e('<div class="sheet-row sheet-row_header flex align-center"><div class="short handle sheet-cell sheet-cell-header flex align-center"></div><div class="short sheet-cell sheet-cell-header flex align-center">\u30D1\u30FC\u30C4<br>\u753B\u50CF</div><div class="short sheet-cell sheet-cell-header flex align-center">\u30AB\u30E9\u30FC<br>\u753B\u50CF</div><div class="sheet-cell sheet-cell-header flex align-center">\u30AB\u30E9\u30FC\u30A2\u30A4\u30C6\u30E0\u540D</div><div class="short sheet-cell sheet-cell-header flex align-center">\u5225\u58F2\u54C1</div><div class="short sheet-cell sheet-cell-header flex align-center">\u30E2\u30C7\u30EB</div></div>',1),we=["onClick","onContextmenu"],De=t("div",{class:"short sheet-cell handle grab flex align-center"},[t("i",{class:"pi pi-bars"})],-1),Ve={class:"short sheet-cell sheet-value-cell flex align-center"},ke={class:"short sheet-cell sheet-value-cell flex align-center"},$e={class:"sheet-cell sheet-value-cell flex align-center"},Ie={class:"block value"},qe={class:"short sheet-cell sheet-value-cell flex align-center"},Re={key:0,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#2ecc71"}},Ue={key:1,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#e74c3c"}},Te={class:"short sheet-cell sheet-value-cell flex align-center"},Se={key:0,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#2ecc71"}},Ne={key:1,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#e74c3c"}},ze={class:"button-wrapper flex justify-end"},Le=J({props:{color_simulator_room_part:{type:Number,default:0},partItems:{type:Array,default:[]}},setup(D){var i;const{get:x,save:h}=se(),{submit:T,submitRowReorder:g,remove:V}=ue(),{d,dr:p,data:F,images:y,useToggle:B}=te(),{findAndUpdateFormElement:k}=je(),{rcm:A,rcmOpened:L,isRCOn:$}=ne(F),{payload:R,content:w,progress:n,project:m}=re();v((i=m.value)==null?void 0:i.links);const C=v(!1),E=v(!1),c=v(pe);function q(){var l;c.value=k(pe,"option","model",!1),c.value=k(c.value,"model_room","model",!1),B({method:"post",endpoints:["app/color_simulator_room_part_items","project_details/"+((l=m.value)==null?void 0:l.id)],state:"project"})}function S(l){var e;C.value=!0,B({method:"patch",endpoints:["app/color_simulator_room_part_items/"+l.id,"project_details/"+((e=m.value)==null?void 0:e.id)],state:"project"},l)}function _(){var l;E.value=!0,V("app/color_simulator_room_part_items/"+((l=F.value)==null?void 0:l.id)).then(()=>{var e;p.value=!1,x("project_details/"+((e=m.value)==null?void 0:e.id),"project").then(()=>{d.value=!1,E.value=!1})})}const N=v([{icon:"pi pi-plus",label:"\u65B0\u898F\u30A2\u30A4\u30C6\u30E0",command:()=>{var l;B({method:"post",endpoints:["app/color_simulator_room_part_items","project_details/"+((l=m.value)==null?void 0:l.id)],state:"project"})}},{icon:"pi pi-trash",label:"\u884C\u3092\u524A\u9664\u3059\u308B",command:()=>{var l;w.value=!0,V("app/color_simulator_room_part_items/"+((l=F.value)==null?void 0:l.id)).then(()=>{var e;x("project_details/"+((e=m.value)==null?void 0:e.id),"project").then(()=>{w.value=!1})})}}]);return(l,e)=>(j(),U("div",Be,[Ae,D.partItems.length?(j(),M(o(ee),{key:0,tag:"div",onEnd:e[0]||(e[0]=u=>o(g)({value:D.partItems},{method:"post",endpoints:["app/color_simulator_room_part_items","project_details/"+o(m).id+"/"],state:"project"})),list:D.partItems,class:"sheet-row",handle:".handle","item-key":"id"},{item:f(({element:u,index:K})=>[t("div",{class:"part-item-box flex align-center pointer",onClick:P=>S(u),onContextmenu:P=>o($)(P,u),"aria-haspopup":"true","aria-controls":"plan_rc_menu"},[r(o(le),{id:"rc_menu",ref_key:"rcm",ref:A,class:"rc has-final-action",model:N.value,popup:!0},null,8,["model"]),De,t("div",Ve,[u.part_image?(j(),M(me,{key:0,svg:"image"})):O("",!0)]),t("div",ke,[u.color_image?(j(),M(me,{key:0,svg:"image"})):O("",!0)]),t("div",$e,[t("span",Ie,W(u.color),1)]),t("div",qe,[u.option?(j(),U("i",Re)):(j(),U("i",Ue))]),t("div",Te,[u.model_room?(j(),U("i",Se)):(j(),U("i",Ne))])],40,we)]),_:1},8,["list"])):O("",!0),t("button",{onClick:e[1]||(e[1]=u=>q()),class:X(["create-item flex align-center justify-center",{mt:D.partItems.length===1}])},"\u65B0\u898F\u30A2\u30A4\u30C6\u30E0 ",2),r(H,{modelValue:o(d),"onUpdate:modelValue":e[7]||(e[7]=u=>b(d)?d.value=u:null),title:"\u30AB\u30E9\u30FC\u30A2\u30A4\u30C6\u30E0\u30D5\u30A9\u30FC\u30E0",overflow:""},{default:f(()=>[r(ae,{modelValue:o(d),"onUpdate:modelValue":e[2]||(e[2]=u=>b(d)?d.value=u:null),dr:o(p),"onUpdate:dr":e[3]||(e[3]=u=>b(p)?p.value=u:null),"close-after":"",form:c.value,data:o(F),query:{color_simulator_room_part:D.color_simulator_room_part},submit:o(T),remove:C.value},null,8,["modelValue","dr","form","data","query","submit","remove"]),r(ie,{modelValue:o(p),"onUpdate:modelValue":e[6]||(e[6]=u=>b(p)?p.value=u:null)},{default:f(()=>[t("div",ze,[t("button",{onClick:e[4]||(e[4]=u=>p.value=!1),class:"cancel"},"\u3044\u3044\u3048"),t("button",{onClick:e[5]||(e[5]=u=>_()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}});const Me={id:"project_color_simulator",class:"panel-board relative"},Oe={class:"part-wrap first flex"},Pe={class:"header flex align-center"},He=t("div",{class:"handle flex align-center grab"},[t("i",{class:"pi pi-bars"})],-1),Ge={class:"title"},Ke={class:"button-wrapper flex justify-end"},Qe=["onUpdate:modelValue"],Je={class:"action-wrapper flex align-center"},_l=J({setup(D){const{d:x,d2:h,data:T,dr:g,rm:V,reform:d,query:p,loading:F,images:y,column:B,content:k,project:A,dropdownItems:L,rcm:$,rooms:R,room:w,roomId:n,isRCOn:m,rowReorder:C,sro:E,open:c,removeItem:q,removeImage:S,submit:_,submitRowReorder:N}=ye();return ve(()=>{var i,l;R.value=((i=A.value)==null?void 0:i.color_simulator_rooms)||[],(l=A.value)==null||l.color_simulator_rooms.forEach((e,u)=>{u===0&&(n.value=e.id)})}),Y(()=>A.value,i=>{R.value=(i==null?void 0:i.color_simulator_rooms)||[],w.value=i==null?void 0:i.color_simulator_rooms.find((l,e)=>n.value===l.id)}),Y(()=>n.value,i=>{var l;w.value=(l=A.value)==null?void 0:l.color_simulator_rooms.find((e,u)=>i===e.id)}),(i,l)=>(j(),U("div",Me,[r(ge,{modelValue:o(k),"onUpdate:modelValue":l[0]||(l[0]=e=>b(k)?k.value=e:null)},null,8,["modelValue"]),r(Ee,{class:"justify-space-between"},{default:f(()=>[t("div",Oe,[r(o(Ce),{style:{"min-width":"120px"},modelValue:o(n),"onUpdate:modelValue":l[1]||(l[1]=e=>b(n)?n.value=e:null),options:o(A).color_simulator_rooms,optionLabel:"name",optionValue:"id",placeholder:"\u30EB\u30FC\u30E0\u9078\u629E"},null,8,["modelValue","options"]),r(o(Z),{type:"button",class:"submit-button icon-button",icon:"pi pi-list",onClick:o(m),"aria-haspopup":"true","aria-controls":"rc_menu"},null,8,["onClick"]),r(o(le),{id:"rc_menu",ref_key:"rcm",ref:$,class:"rc",model:o(L),popup:!0},null,8,["model"])])]),_:1}),o(w)?(j(),M(o(ee),{key:0,tag:"div",onEnd:l[2]||(l[2]=e=>o(N)({value:o(w).room_parts},{method:"post",endpoints:["app/color_simulator_room_parts","project_details/"+o(A).id],state:"project"})),list:o(w).room_parts,class:"room-parts-wrapper flex justify-space-between",handle:".handle","item-key":"id"},{item:f(({element:e,index:u})=>[t("div",{class:X(["room-part-container",[o(B)]])},[t("div",Pe,[He,t("div",Ge,W(e.name),1),r(o(Z),{onClick:K=>o(c)(e),type:"button",class:"edit",icon:"pi pi-pencil","icon-pos":"left","aria-haspopup":"true"},null,8,["onClick"])]),r(Le,{color_simulator_room_part:e.id,partItems:e.room_part_items},null,8,["color_simulator_room_part","partItems"])],2)]),_:1},8,["list"])):O("",!0),r(H,{modelValue:o(x),"onUpdate:modelValue":l[8]||(l[8]=e=>b(x)?x.value=e:null),title:"\u30EB\u30FC\u30E0\u30D5\u30A9\u30FC\u30E0"},{default:f(()=>[r(ae,{modelValue:o(x),"onUpdate:modelValue":l[3]||(l[3]=e=>b(x)?x.value=e:null),dr:o(g),"onUpdate:dr":l[4]||(l[4]=e=>b(g)?g.value=e:null),"close-after":"",form:o(d),data:o(T),remove:o(V),query:o(p),submit:o(_)},{default:f(()=>[r(xe,{containerId:"room_image_input",images:o(y),remove:o(S)},null,8,["images","remove"])]),_:1},8,["modelValue","dr","form","data","remove","query","submit"]),r(ie,{modelValue:o(g),"onUpdate:modelValue":l[7]||(l[7]=e=>b(g)?g.value=e:null)},{default:f(()=>[t("div",Ke,[t("button",{onClick:l[5]||(l[5]=e=>g.value=!1),class:"cancel"},"\u3044\u3044\u3048"),t("button",{onClick:l[6]||(l[6]=e=>o(q)()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),r(H,{modelValue:o(h),"onUpdate:modelValue":l[12]||(l[12]=e=>b(h)?h.value=e:null),title:"\u30EB\u30FC\u30E0\u9806\u756A"},{default:f(()=>[r(Fe,{modelValue:o(h),"onUpdate:modelValue":l[11]||(l[11]=e=>b(h)?h.value=e:null),"close-after":"",form:o(d)},{actions:f(()=>[t("div",Je,[t("button",{onClick:l[9]||(l[9]=e=>h.value=!1),class:"flex align-center justify-center cancel"},"\u4E2D\u6B62"),t("button",{onClick:l[10]||(l[10]=e=>o(E)()),class:"flex align-center justify-center submit-or-next"},"\u767B\u9332 ")])]),default:f(()=>[r(o(be),{value:o(R),rowindex:"index",onRowReorder:o(C),responsiveLayout:"scroll",class:"option-datatable"},{default:f(()=>[r(o(oe),{rowReorder:!0,headerStyle:"width: 3rem",reorderableColumn:!1}),r(o(oe),{field:"name",header:"\u30EB\u30FC\u30E0\u540D"},{body:f(e=>[fe(t("input",{class:"option-input",type:"text","onUpdate:modelValue":u=>e.data.name=u,placeholder:"\u9078\u629E\u9805\u76EE"},null,8,Qe),[[he,e.data.name]])]),_:1})]),_:1},8,["value","onRowReorder"])]),_:1},8,["modelValue","form"])]),_:1},8,["modelValue"])]))}});export{_l as default};
