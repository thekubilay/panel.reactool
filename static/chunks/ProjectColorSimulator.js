import{A as le,u as oe,l as f,L as ce,d as ue,c as U,e as O,w as v,b as o,f as M,h as t,n as te,g as r,p as b,P as _e,o as y,t as ae,m as ve,D as Q,s as W,a1 as fe,bO as he}from"../main.js";import{D as se}from"./vuedraggable.umd.js";import{s as Ce}from"./dropdown.esm.js";import{s as re}from"./menu.esm.js";import{s as be,a as X}from"./column.esm.js";import{_ as G}from"./Dialog.js";import{S as xe}from"./Spinner.js";import{_ as ge}from"./BarTool.js";import{_ as ne}from"./FormQuery.js";import{_ as Ee}from"./ContextImagesThumbnailContainer.js";import{a as ie,u as me}from"./useFormRequestBuilder.js";import{u as de}from"./useRightClickHandler.js";import{_ as pe}from"./DialogDelete.js";import{_ as Fe}from"./FormNested.js";import{_ as Y}from"./Icon.js";import{u as ye}from"./useUtils.js";import"./_commonjsHelpers.js";import"./index.esm.js";import"./virtualscroller.esm.js";import"./portal.esm.js";import"./index.esm2.js";import"./index.esm3.js";import"./plugin-vue_export-helper.js";const H=[[{classes:["flex"],elements:[{component:null,name:"InputText",db_column_name:"name",type:"text",model:null,label:"\u30EB\u30FC\u30E0\u540D",hint:null,placeholder:"\u30EA\u30D3\u30F3\u30B0",required:!0,id:"name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"Textarea",db_column_name:"option_context",type:"text",model:null,label:"\u30AA\u30D7\u30B7\u30E7\u30F3\u5185\u5BB9",hint:null,placeholder:"\u3007\u3007\u30AA\u30D7\u30B7\u30E7\u30F3",required:!1,autoResize:!1,rows:"40",cols:"30",id:"option_context_input",rules:[],disabled:!1,props:["placeholder","required","disabled","autoResize"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"image",type:"text",model:null,label:"BASE\u753B\u50CF",hint:".jpeg, .png \u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!1,id:"room_image_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[],rule:null,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]}]],Z=[[{classes:["flex","justify-space-between"],elements:[{component:null,name:"InputText",db_column_name:"name",type:"text",model:null,label:"PART\u540D",hint:null,placeholder:"\u5E8A",required:!0,id:"part_name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-2-space"]},{component:null,name:"InputNumber",db_column_name:"column_count",type:"text",model:4,label:"\u30AB\u30FC\u30C9\u6570",hint:"\u4E00\u884C\u306B\u4E26\u3073\u305F\u3044\u30AB\u30E9\u30FC\u30AB\u30FC\u30C9\u6570",placeholder:"4",required:!0,id:"column_count_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-2-space"]}]}]];function Be(){const{get:D,save:E}=le(),{submit:h,submitRowReorder:S,remove:x}=ie(),{d:V,d2:d,dr:p,data:F,images:B,useToggle:j}=me(),{rcm:$,rcmOpened:A,isRCOn:L}=de(F),{payload:k,content:R,progress:w,project:n}=oe(),m=f(!1),C=f(!1),g=f(null),c=f(H),q=f([]),T=f(null),_=f(),P=f([{icon:"pi pi-plus",label:"\u30EB\u30FC\u30E0\u3092\u8FFD\u52A0",command:()=>{var a,s;m.value=!1,g.value={project:((a=n.value)==null?void 0:a.id)||null},B.value=[],c.value=H,j({method:"post",endpoints:["app/color_simulator_rooms","project_details/"+((s=n.value)==null?void 0:s.id)],state:"project"})}},{icon:"pi pi-pencil",label:"\u30EB\u30FC\u30E0\u7DE8\u96C6",command:()=>{var a,s,I,z,K;m.value=!0,g.value={project:((a=n.value)==null?void 0:a.id)||null},c.value=H,B.value=(s=_.value)!=null&&s.image?[{image:(I=_.value)==null?void 0:I.image}]:[],j({method:"patch",endpoints:["app/color_simulator_rooms/"+((z=_.value)==null?void 0:z.id),"project_details/"+((K=n.value)==null?void 0:K.id)],state:"project"},_.value)}},{icon:"pi pi-bars",label:"\u30EB\u30FC\u30E0\u306E\u4E26\u3073\u66FF\u3048",command:()=>{var a;m.value=!1,c.value=[[]],B.value=[],k.value={method:"post",endpoints:["app/color_simulator_rooms","project_details/"+((a=n.value)==null?void 0:a.id)],state:"project"},d.value=!0}},{icon:"pi pi-plus",label:"\u30EB\u30FC\u30E0\u30D1\u30FC\u30C4\u3092\u8FFD\u52A0",command:()=>{var a,s;B.value=[],m.value=!1,g.value={color_simulator_room:(a=_.value)==null?void 0:a.id},c.value=Z,k.value={method:"post",endpoints:["app/color_simulator_room_parts","project_details/"+((s=n.value)==null?void 0:s.id)],state:"project"},V.value=!0}}]),i=ce(()=>{var a,s;return((a=_.value)==null?void 0:a.room_parts.length)>1?"column-"+((s=_.value)==null?void 0:s.room_parts.length)+"-space":"column-2-space"});return{d:V,d2:d,data:F,dr:p,rm:m,reform:c,query:g,loading:C,images:B,column:i,content:R,project:n,dropdownItems:P,rcm:$,rooms:q,room:_,roomId:T,isRCOn:L,rowReorder:a=>{q.value=a.value},sro:()=>{var a;C.value=!0,k.value={method:"post",endpoints:["app/color_simulator_rooms","project_details/"+((a=n.value)==null?void 0:a.id)],state:"project"},h({reordered:q.value},null,"object").then(()=>{C.value=!1,d.value=!1})},open:a=>{var s,I;g.value={color_simulator_room:(s=_.value)==null?void 0:s.id},c.value=Z,m.value=!0,j({method:"patch",endpoints:["app/color_simulator_room_parts/"+a.id,"project_details/"+((I=n.value)==null?void 0:I.id)],state:"project"},a)},removeItem:()=>{var s,I;C.value=!0;const a=(s=g.value)!=null&&s.hasOwnProperty("project")?"app/color_simulator_rooms/":"app/color_simulator_room_parts/";x(a+((I=F.value)==null?void 0:I.id)).then(()=>{var z;p.value=!1,D("project_details/"+((z=n.value)==null?void 0:z.id),"project").then(()=>{V.value=!1,C.value=!1})})},removeImage:a=>{var s;C.value=!0,k.value={method:"patch",endpoints:["app/color_simulator_rooms/"+F.value.id,"project_details/"+((s=n.value)==null?void 0:s.id)],state:"project"},h({image:null,thumbnail:null},null,"object").then(()=>{C.value=!1,B.value=[]})},submit:h,submitRowReorder:S}}const ee=[[{classes:["flex","justify-space-between"],elements:[{component:null,name:"Dropdown",db_column_name:"option",type:"text",model:!1,label:"\u5225\u58F2\u54C1",hint:null,required:!0,rules:[],id:"option_input",disabled:!1,options:[{name:"\u306F\u3044",value:!0},{name:"\u3044\u3044\u3048",value:!1}],optionLabel:"name",optionValue:"value",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]},{component:null,name:"Dropdown",db_column_name:"model_room",type:"text",model:!1,label:"\u30E2\u30C7\u30EB\u30EB\u30FC\u30E0",hint:null,required:!0,rules:[],id:"model_room_input",disabled:!1,options:[{name:"\u306F\u3044",value:!0},{name:"\u3044\u3044\u3048",value:!1}],optionLabel:"name",optionValue:"value",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]}]},{classes:["flex"],elements:[{component:null,name:"InputText",db_column_name:"color",type:"text",model:null,label:"\u30AB\u30E9\u30FC\u30A2\u30A4\u30C6\u30E0\u540D",hint:null,placeholder:"\u30FC",required:!0,id:"name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"part_image",type:"text",model:null,label:"\u30D1\u30FC\u30C4\u753B\u50CF",hint:".png \u304C\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!1,id:"part_image_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[],rule:null,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"color_image",type:"text",model:null,label:"\u30AB\u30E9\u30FC\u753B\u50CF",hint:".png \u3068 .jpeg \u304C\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!1,id:"color_image_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[],rule:null,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]}]];const je={class:"room-part-items-wrapper"},Ae=_e('<div class="sheet-row sheet-row_header flex align-center"><div class="short handle sheet-cell sheet-cell-header flex align-center"></div><div class="short sheet-cell sheet-cell-header flex align-center">\u30D1\u30FC\u30C4<br>\u753B\u50CF</div><div class="short sheet-cell sheet-cell-header flex align-center">\u30AB\u30E9\u30FC<br>\u753B\u50CF</div><div class="sheet-cell sheet-cell-header flex align-center">\u30AB\u30E9\u30FC\u30A2\u30A4\u30C6\u30E0\u540D</div><div class="short sheet-cell sheet-cell-header flex align-center">\u5225\u58F2\u54C1</div><div class="short sheet-cell sheet-cell-header flex align-center">\u30E2\u30C7\u30EB</div></div>',1),we=["onClick","onContextmenu"],De=t("div",{class:"short sheet-cell handle grab flex align-center"},[t("i",{class:"pi pi-bars"})],-1),Ve={class:"short sheet-cell sheet-value-cell flex align-center"},$e={class:"short sheet-cell sheet-value-cell flex align-center"},ke={class:"sheet-cell sheet-value-cell flex align-center"},Ie={class:"block value"},qe={class:"short sheet-cell sheet-value-cell flex align-center"},Re={key:0,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#2ecc71"}},Ue={key:1,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#e74c3c"}},Se={class:"short sheet-cell sheet-value-cell flex align-center"},Te={key:0,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#2ecc71"}},Pe={key:1,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#e74c3c"}},ze={class:"button-wrapper flex justify-end"},Le=ue({__name:"ContextColorSimulatorRoomPartItems",props:{color_simulator_room_part:{type:Number,default:0},partItems:{type:Array,default:[]}},setup(D){var i;const{get:E,save:h}=le(),{submit:S,submitRowReorder:x,remove:V}=ie(),{d,dr:p,data:F,images:B,useToggle:j}=me(),{findAndUpdateFormElement:$}=ye(),{rcm:A,rcmOpened:L,isRCOn:k}=de(F),{payload:R,content:w,progress:n,project:m}=oe();f((i=m.value)==null?void 0:i.links);const C=f(!1),g=f(!1),c=f(ee);function q(){var l;c.value=$(ee,"option","model",!1),c.value=$(c.value,"model_room","model",!1),j({method:"post",endpoints:["app/color_simulator_room_part_items","project_details/"+((l=m.value)==null?void 0:l.id)],state:"project"})}function T(l){var e;C.value=!0,j({method:"patch",endpoints:["app/color_simulator_room_part_items/"+l.id,"project_details/"+((e=m.value)==null?void 0:e.id)],state:"project"},l)}function _(){var l;g.value=!0,V("app/color_simulator_room_part_items/"+((l=F.value)==null?void 0:l.id)).then(()=>{var e;p.value=!1,E("project_details/"+((e=m.value)==null?void 0:e.id),"project").then(()=>{d.value=!1,g.value=!1})})}const P=f([{icon:"pi pi-plus",label:"\u65B0\u898F\u30A2\u30A4\u30C6\u30E0",command:()=>{var l;j({method:"post",endpoints:["app/color_simulator_room_part_items","project_details/"+((l=m.value)==null?void 0:l.id)],state:"project"})}},{icon:"pi pi-trash",label:"\u884C\u3092\u524A\u9664\u3059\u308B",command:()=>{var l;w.value=!0,V("app/color_simulator_room_part_items/"+((l=F.value)==null?void 0:l.id)).then(()=>{var e;E("project_details/"+((e=m.value)==null?void 0:e.id),"project").then(()=>{w.value=!1})})}}]);return(l,e)=>(y(),U("div",je,[Ae,D.partItems.length?(y(),O(o(se),{key:0,tag:"div",onEnd:e[0]||(e[0]=u=>o(x)({value:D.partItems},{method:"post",endpoints:["app/color_simulator_room_part_items","project_details/"+o(m).id+"/"],state:"project"})),list:D.partItems,class:"sheet-row",handle:".handle","item-key":"id"},{item:v(({element:u,index:J})=>[t("div",{class:"part-item-box flex align-center pointer",onClick:N=>T(u),onContextmenu:N=>o(k)(N,u),"aria-haspopup":"true","aria-controls":"plan_rc_menu"},[r(o(re),{id:"rc_menu",ref_key:"rcm",ref:A,class:"rc has-final-action",model:P.value,popup:!0},null,8,["model"]),De,t("div",Ve,[u.part_image?(y(),O(Y,{key:0,svg:"image"})):M("",!0)]),t("div",$e,[u.color_image?(y(),O(Y,{key:0,svg:"image"})):M("",!0)]),t("div",ke,[t("span",Ie,ae(u.color),1)]),t("div",qe,[u.option?(y(),U("i",Re)):(y(),U("i",Ue))]),t("div",Se,[u.model_room?(y(),U("i",Te)):(y(),U("i",Pe))])],40,we)]),_:1},8,["list"])):M("",!0),t("button",{onClick:e[1]||(e[1]=u=>q()),class:te(["create-item flex align-center justify-center",{mt:D.partItems.length===1}])},"\u65B0\u898F\u30A2\u30A4\u30C6\u30E0 ",2),r(G,{modelValue:o(d),"onUpdate:modelValue":e[7]||(e[7]=u=>b(d)?d.value=u:null),title:"\u30AB\u30E9\u30FC\u30A2\u30A4\u30C6\u30E0\u30D5\u30A9\u30FC\u30E0",overflow:""},{default:v(()=>[r(ne,{modelValue:o(d),"onUpdate:modelValue":e[2]||(e[2]=u=>b(d)?d.value=u:null),dr:o(p),"onUpdate:dr":e[3]||(e[3]=u=>b(p)?p.value=u:null),"close-after":"",form:c.value,data:o(F),query:{color_simulator_room_part:D.color_simulator_room_part},submit:o(S),remove:C.value},null,8,["modelValue","dr","form","data","query","submit","remove"]),r(pe,{modelValue:o(p),"onUpdate:modelValue":e[6]||(e[6]=u=>b(p)?p.value=u:null)},{default:v(()=>[t("div",ze,[t("button",{onClick:e[4]||(e[4]=u=>p.value=!1),class:"cancel"},"\u3044\u3044\u3048"),t("button",{onClick:e[5]||(e[5]=u=>_()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}});const Oe={id:"project_color_simulator",class:"panel-board relative"},Me={class:"part-wrap first flex"},Ne={class:"header flex align-center"},He=t("div",{class:"handle flex align-center grab"},[t("i",{class:"pi pi-bars"})],-1),Ge={class:"title"},Je={class:"button-wrapper flex justify-end"},Ke=["onUpdate:modelValue"],Qe={class:"action-wrapper flex align-center"},bl=ue({__name:"ProjectColorSimulator",setup(D){const{d:E,d2:h,data:S,dr:x,rm:V,reform:d,query:p,loading:F,images:B,column:j,content:$,project:A,dropdownItems:L,rcm:k,rooms:R,room:w,roomId:n,isRCOn:m,rowReorder:C,sro:g,open:c,removeItem:q,removeImage:T,submit:_,submitRowReorder:P}=Be();return ve(()=>{var i,l;R.value=((i=A.value)==null?void 0:i.color_simulator_rooms)||[],(l=A.value)==null||l.color_simulator_rooms.forEach((e,u)=>{u===0&&(n.value=e.id)})}),Q(()=>A.value,i=>{R.value=(i==null?void 0:i.color_simulator_rooms)||[],w.value=i==null?void 0:i.color_simulator_rooms.find((l,e)=>n.value===l.id)}),Q(()=>n.value,i=>{var l;w.value=(l=A.value)==null?void 0:l.color_simulator_rooms.find((e,u)=>i===e.id)}),(i,l)=>(y(),U("div",Oe,[r(xe,{modelValue:o($),"onUpdate:modelValue":l[0]||(l[0]=e=>b($)?$.value=e:null)},null,8,["modelValue"]),r(ge,{class:"justify-space-between"},{default:v(()=>[t("div",Me,[r(o(Ce),{style:{"min-width":"120px"},modelValue:o(n),"onUpdate:modelValue":l[1]||(l[1]=e=>b(n)?n.value=e:null),options:o(A).color_simulator_rooms,optionLabel:"name",optionValue:"id",placeholder:"\u30EB\u30FC\u30E0\u9078\u629E"},null,8,["modelValue","options"]),r(o(W),{type:"button",class:"submit-button icon-button",icon:"pi pi-list",onClick:o(m),"aria-haspopup":"true","aria-controls":"rc_menu"},null,8,["onClick"]),r(o(re),{id:"rc_menu",ref_key:"rcm",ref:k,class:"rc",model:o(L),popup:!0},null,8,["model"])])]),_:1}),o(w)?(y(),O(o(se),{key:0,tag:"div",onEnd:l[2]||(l[2]=e=>o(P)({value:o(w).room_parts},{method:"post",endpoints:["app/color_simulator_room_parts","project_details/"+o(A).id],state:"project"})),list:o(w).room_parts,class:"room-parts-wrapper flex justify-space-between",handle:".handle","item-key":"id"},{item:v(({element:e,index:u})=>[t("div",{class:te(["room-part-container",[o(j)]])},[t("div",Ne,[He,t("div",Ge,ae(e.name),1),r(o(W),{onClick:J=>o(c)(e),type:"button",class:"edit",icon:"pi pi-pencil","icon-pos":"left","aria-haspopup":"true"},null,8,["onClick"])]),r(Le,{color_simulator_room_part:e.id,partItems:e.room_part_items},null,8,["color_simulator_room_part","partItems"])],2)]),_:1},8,["list"])):M("",!0),r(G,{modelValue:o(E),"onUpdate:modelValue":l[8]||(l[8]=e=>b(E)?E.value=e:null),title:"\u30EB\u30FC\u30E0\u30D5\u30A9\u30FC\u30E0"},{default:v(()=>[r(ne,{modelValue:o(E),"onUpdate:modelValue":l[3]||(l[3]=e=>b(E)?E.value=e:null),dr:o(x),"onUpdate:dr":l[4]||(l[4]=e=>b(x)?x.value=e:null),"close-after":"",form:o(d),data:o(S),remove:o(V),query:o(p),submit:o(_)},{default:v(()=>[r(Ee,{containerId:"room_image_input",images:o(B),remove:o(T)},null,8,["images","remove"])]),_:1},8,["modelValue","dr","form","data","remove","query","submit"]),r(pe,{modelValue:o(x),"onUpdate:modelValue":l[7]||(l[7]=e=>b(x)?x.value=e:null)},{default:v(()=>[t("div",Je,[t("button",{onClick:l[5]||(l[5]=e=>x.value=!1),class:"cancel"},"\u3044\u3044\u3048"),t("button",{onClick:l[6]||(l[6]=e=>o(q)()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),r(G,{modelValue:o(h),"onUpdate:modelValue":l[12]||(l[12]=e=>b(h)?h.value=e:null),title:"\u30EB\u30FC\u30E0\u9806\u756A"},{default:v(()=>[r(Fe,{modelValue:o(h),"onUpdate:modelValue":l[11]||(l[11]=e=>b(h)?h.value=e:null),"close-after":"",form:o(d)},{actions:v(()=>[t("div",Qe,[t("button",{onClick:l[9]||(l[9]=e=>h.value=!1),class:"flex align-center justify-center cancel"},"\u4E2D\u6B62"),t("button",{onClick:l[10]||(l[10]=e=>o(g)()),class:"flex align-center justify-center submit-or-next"},"\u767B\u9332 ")])]),default:v(()=>[r(o(be),{value:o(R),rowindex:"index",onRowReorder:o(C),responsiveLayout:"scroll",class:"option-datatable"},{default:v(()=>[r(o(X),{rowReorder:!0,headerStyle:"width: 3rem",reorderableColumn:!1}),r(o(X),{field:"name",header:"\u30EB\u30FC\u30E0\u540D"},{body:v(e=>[fe(t("input",{class:"option-input",type:"text","onUpdate:modelValue":u=>e.data.name=u,placeholder:"\u9078\u629E\u9805\u76EE"},null,8,Ke),[[he,e.data.name]])]),_:1})]),_:1},8,["value","onRowReorder"])]),_:1},8,["modelValue","form"])]),_:1},8,["modelValue"])]))}});export{bl as default};
