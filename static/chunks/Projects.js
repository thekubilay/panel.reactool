import{s as R}from"./dropdown.esm.js";import{d as q,A as z,u as I,k as N,j as S,r as A,m as P,c as f,b as i,q as d,e as t,f as l,z as p,a2 as H,o as _,M,t as h}from"../main.js";import{D as T}from"./vuedraggable.umd.js";import{_ as G}from"./Dialog.js";import{_ as J}from"./FormQuery.js";import{_ as K}from"./DialogDelete.js";import{_ as L}from"./BarTool.js";import{u as O,a as Q}from"./useFormRequestBuilder.js";import{c as g}from"./FormProject.js";import{u as W}from"./useUtils.js";import"./index.esm.js";import"./virtualscroller.esm.js";import"./portal.esm.js";import"./_commonjsHelpers.js";import"./Spinner.js";import"./plugin-vue_export-helper.js";import"./rules.js";const X={id:"admin-projects",class:"admin-board"},Y={class:"part-wrap"},Z={class:"part-wrap part-end"},ee={class:"spreadsheet-wrapper overflow-x"},se=H('<div class="sh-container ss-container"><div class="sheet-row sheet-row-header flex align-center"><div class="sheet-cell handle flex align-center"></div><div class="sheet-cell num flex align-center">\u9806\u756A</div><div class="sheet-cell value flex align-center">ID</div><div class="sheet-cell sheet-cell-long value flex align-center">\u30D7\u30ED\u30B8\u30A7\u30AF\u30C8\u540D</div><div class="sheet-cell value flex align-center">\u30AA\u30F3\u30E9\u30A4\u30F3</div></div></div>',1),te=["onClick"],oe=t("div",{class:"sheet-cell handle flex align-center handle grab"},[t("i",{class:"pi pi-bars"})],-1),le={class:"sheet-cell num flex align-center"},ae={class:"text block"},ne={class:"sheet-cell sheet-cell value flex align-center"},ie={class:"text block"},re={class:"sheet-cell sheet-cell-long value flex align-center"},ue={class:"text block"},ce={class:"sheet-cell sheet-cell value flex align-center"},de={class:"text block"},pe={key:0,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#2ecc71"}},me={key:1,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#e74c3c"}},ve={class:"button-wrapper flex justify-end"},Ne=q({__name:"Projects",setup(fe){const{get:b}=z(),{store:_e,progress:he,user:ge,companies:w,company:r,users:be,content:c}=I(),{submit:C,remove:D,submitRowReorder:j}=O(),{d:n,dr:a,data:x,useToggle:y}=Q(),{findAndUpdateFormElement:k}=W(),u=N(),$=S(),m=A(g),v=A(!1),V=P({set(o){c.value=!0,$.push({params:{cid:o}}),b("companies/"+o,"company").then(()=>{c.value=!1})},get(){var o;return(o=r.value)==null?void 0:o.id}});function F(){var o;m.value=k(g,"salon","options",(o=r.value)==null?void 0:o.salons),v.value=!1,y({method:"post",endpoints:["projects","companies/"+u.params.cid],state:"company"})}function B(o){var e;m.value=k(g,"salon","options",(e=r.value)==null?void 0:e.salons),v.value=!0,y({method:"patch",endpoints:["projects/"+o.id,"companies/"+u.params.cid],state:"company"},o)}function E(){var o;c.value=!0,D("projects/"+((o=x.value)==null?void 0:o.id)).then(()=>{b("companies/"+u.params.cid,"company").then(()=>{a.value=!1,n.value=!1,c.value=!1})})}return(o,e)=>(_(),f("div",X,[i(L,{class:"justify-space-between"},{default:d(()=>[t("div",Y,[i(l(M),{type:"button",class:"submit-button",icon:"pi pi-plus","icon-pos":"left",label:"\u65B0\u898F\u30D7\u30ED\u30B8\u30A7\u30AF\u30C8",onClick:e[0]||(e[0]=s=>F())})]),t("div",Z,[i(l(R),{style:{width:"140px"},class:"dropdown",modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=s=>V.value=s),"option-label":"name","option-value":"id",options:l(w)},null,8,["modelValue","options"])])]),_:1}),t("div",ee,[se,i(l(T),{tag:"div",onEnd:e[2]||(e[2]=s=>l(j)({value:l(r).projects},{method:"post",endpoints:["projects","companies/"+l(u).params.cid],state:"company"})),list:l(r).projects,class:"sb-container ss-container",handle:".handle","item-key":"id"},{item:d(({element:s,index:U})=>[t("div",{onClick:xe=>B(s),class:"sheet-row flex align-center list-group-item relative pointer"},[oe,t("div",le,[t("span",ae,h(s.order_id?s.order_id:U+1),1)]),t("div",ne,[t("span",ie,h(s.id),1)]),t("div",re,[t("span",ue,h(s.name),1)]),t("div",ce,[t("span",de,[s.archive?(_(),f("i",me)):(_(),f("i",pe))])])],8,te)]),_:1},8,["list"])]),i(G,{modelValue:l(n),"onUpdate:modelValue":e[8]||(e[8]=s=>p(n)?n.value=s:null),title:"\u30D7\u30ED\u30B8\u30A7\u30AF\u30C8\u30D5\u30A9\u30FC\u30E0"},{default:d(()=>[i(J,{modelValue:l(n),"onUpdate:modelValue":e[3]||(e[3]=s=>p(n)?n.value=s:null),dr:l(a),"onUpdate:dr":e[4]||(e[4]=s=>p(a)?a.value=s:null),"close-after":"",form:m.value,query:{company:l(u).params.cid},data:l(x),remove:v.value,submit:l(C)},null,8,["modelValue","dr","form","query","data","remove","submit"]),i(K,{modelValue:l(a),"onUpdate:modelValue":e[7]||(e[7]=s=>p(a)?a.value=s:null)},{default:d(()=>[t("div",ve,[t("button",{onClick:e[5]||(e[5]=s=>a.value=!1),class:"cancel"},"\u3044\u3044\u3048"),t("button",{onClick:e[6]||(e[6]=s=>E()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}});export{Ne as default};
