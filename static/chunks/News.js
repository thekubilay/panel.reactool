import{d as D,A as N,k as S,u as U,r as v,a as R,c as d,b as n,q as _,e,F as z,s as I,f as u,z as b,a1 as L,o as m,L as O,t as h,h as T,Y as H,n as C,g as M,i as x}from"../main.js";import{s as P}from"./dropdown.esm.js";import{s as Y}from"./editor.esm.js";import{_ as G}from"./Dialog.js";import{_ as J}from"./DialogDelete.js";import{_ as K}from"./BarTool.js";import{a as Q,u as W}from"./useFormRequestBuilder.js";import{S as X}from"./Spinner.js";import"./index.esm.js";import"./virtualscroller.esm.js";import"./portal.esm.js";import"./plugin-vue_export-helper.js";const Z={id:"admin-app-news",class:"admin-board"},ee={class:"part-wrap"},te={class:"spreadsheet-wrapper overflow-x"},se=L('<div class="sh-container ss-container"><div class="sheet-row sheet-row-header flex align-center"><div class="sheet-cell num flex align-center">#</div><div class="sheet-cell value flex align-center">\u30CB\u30E5\u30FC\u30B9\u7A2E\u985E</div><div class="sheet-cell sheet-cell-long flex align-center">\u30BF\u30A4\u30C8\u30EB</div><div class="sheet-cell sheet-cell-long flex align-center">\u516C\u958B\u65E5</div></div></div>',1),le={class:"sb-container ss-container"},oe=["onClick"],ne=e("div",{class:"sheet-cell num flex align-center"},null,-1),ae={class:"sheet-cell value flex align-center"},ue={class:"text block"},ie={class:"sheet-cell sheet-cell-long flex align-center"},re={class:"text block"},ce={class:"sheet-cell value flex align-center"},de={class:"text block"},me={id:"form"},fe=["onSubmit"],pe={class:"row flex justify-space-between"},ve={class:"flex-column column-1 relative"},_e=e("span",{class:"label flex"},[x("\u30CB\u30E5\u30FC\u30B9\u7A2E\u985E"),e("span",{class:"required flex align-start"},"*\u5FC5\u9808")],-1),he={class:"row flex justify-space-between"},xe={class:"flex-column column-1 relative"},we=e("span",{class:"label flex"},[x("\u30BF\u30A4\u30C8\u30EB"),e("span",{class:"required flex align-start"},"*\u5FC5\u9808")],-1),ge={class:"row flex justify-space-between"},be={class:"flex-column column-1 relative"},Ce=e("span",{class:"label flex"},[x("\u5185\u5BB9"),e("span",{class:"required flex align-start"},"*\u5FC5\u9808")],-1),ye={class:"action-wrapper flex align-center"},Ve=e("button",{class:"flex align-center justify-center cancel"},"\u4E2D\u6B62",-1),Be={class:"button-wrapper flex justify-end"},Le=D({__name:"News",setup(Fe){const{get:f}=N();S();const{payload:y,content:w,user:Ee,news:V}=U(),{d:i,dr:a,data:B,useToggle:g}=Q(),{remove:F,submitAsFormObject:E}=W(),p=v(!1),l=R({type:{required:!0,model:"\u30D1\u30D6\u30EA\u30C3\u30AF",error:!1},title:{required:!0,model:null,error:!1},content:{required:!0,model:null,error:!1}}),A=v(["\u4F1A\u793E\u7528","\u30D1\u30D6\u30EA\u30C3\u30AF"]),c=v(!1);function k(){p.value=!1,l.type.model="\u30D1\u30D6\u30EA\u30C3\u30AF",l.title.model=null,l.content.model=null,g({method:"post",endpoints:["news","news"],state:"news"})}function $(o){p.value=!0,g({method:"patch",endpoints:["news/"+o.id,"news"],state:"news"},o),l.type.model=o.type,l.title.model=o.title,l.content.model=o.content}function j(){var o;w.value=!0,y.value={method:"get",endpoints:["news","news"],state:"news"},F("news/"+((o=B.value)==null?void 0:o.id)).then(()=>{f("news","news").then(()=>{a.value=!1,i.value=!1,w.value=!1})})}function q(){c.value=!0;let o=[];const t={type:l.type.model,title:l.title.model,content:l.content.model};Object.keys(l).forEach(r=>{(l[r].model===""||!l[r].model)&&(l[r].error=!0,o.push(r))}),o.length||E(t).then(()=>f("news","news")).then(()=>{f("users/current","user").then(()=>{c.value=!1,i.value=!1,a.value=!1})})}return(o,t)=>(m(),d("div",Z,[n(K,{class:"justify-space-between"},{default:_(()=>[e("div",ee,[n(u(O),{type:"button",class:"submit-button",icon:"pi pi-plus","icon-pos":"left",label:"\u65B0\u898F\u6A29\u9650",onClick:t[0]||(t[0]=s=>k())})])]),_:1}),e("div",te,[se,e("div",le,[(m(!0),d(z,null,I(u(V),s=>(m(),d("div",{onClick:r=>$(s),class:"sheet-row flex align-center list-group-item relative pointer"},[ne,e("div",ae,[e("span",ue,h(s.type),1)]),e("div",ie,[e("span",re,h(s.title),1)]),e("div",ce,[e("span",de,h(s.created_at),1)])],8,oe))),256))])]),n(G,{modelValue:u(i),"onUpdate:modelValue":t[10]||(t[10]=s=>b(i)?i.value=s:null),title:"\u30CB\u30E5\u30FC\u30B9\u30D5\u30A9\u30FC\u30E0"},{default:_(()=>[n(X,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=s=>c.value=s)},null,8,["modelValue"]),e("div",me,[e("form",{action:"",onSubmit:T(s=>!1,["prevent"])},[e("div",pe,[e("div",ve,[_e,n(u(P),{class:"cfec",modelValue:l.type.model,"onUpdate:modelValue":t[2]||(t[2]=s=>l.type.model=s),options:A.value},null,8,["modelValue","options"])])]),e("div",he,[e("div",xe,[we,n(u(H),{class:C(["cfec",{error:l.title.error}]),modelValue:l.title.model,"onUpdate:modelValue":t[3]||(t[3]=s=>l.title.model=s)},null,8,["class","modelValue"])])]),e("div",ge,[e("div",be,[Ce,n(u(Y),{class:C({error:l.title.error}),modelValue:l.content.model,"onUpdate:modelValue":t[4]||(t[4]=s=>l.content.model=s)},null,8,["class","modelValue"])])]),e("div",ye,[Ve,p.value?(m(),d("button",{key:0,onClick:t[5]||(t[5]=s=>a.value=!0),class:"flex align-center justify-center remove"},"\u524A\u9664")):M("",!0),e("button",{onClick:t[6]||(t[6]=s=>q()),class:"flex align-center justify-center submit-or-next"},"\u767B\u9332")])],40,fe)]),n(J,{modelValue:u(a),"onUpdate:modelValue":t[9]||(t[9]=s=>b(a)?a.value=s:null)},{default:_(()=>[e("div",Be,[e("button",{onClick:t[7]||(t[7]=s=>a.value=!1),class:"cancel"},"\u3044\u3044\u3048"),e("button",{onClick:t[8]||(t[8]=s=>j()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}});export{Le as default};
