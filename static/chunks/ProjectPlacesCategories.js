import{D as M}from"./vuedraggable.umd.js";import{a as O,C as c,o as Q,N as W,q as X,f as n,t,D as v,w as f,x as o,W as z,X as J,B as K,b as Y,G as D,A as w}from"./vendor.js";import{s as Z}from"./menu.esm.js";import{S as ee}from"./Spinner.js";import{_ as le}from"./BarTool.js";import{_ as ae}from"./Dialog.js";import{_ as ue}from"./FormQuery.js";import{_ as te}from"./ContextImagesThumbnailContainer.js";import{A as oe,u as se}from"../main.js";import{u as ne,a as re}from"./useFormRequestBuilder.js";import{u as ie}from"./useRightClickHandler.js";import{_ as de}from"./DialogDelete.js";import"./overlayeventbus.esm.js";import"./plugin-vue_export-helper.js";import"./Icon.js";const A=[[{classes:["flex","justify-space-between"],elements:[{component:null,name:"Dropdown",db_column_name:"empty",type:"text",model:!1,label:"\u30AB\u30C6\u30B4\u30EA\u30FC\u30BF\u30A4\u30D7",hint:"\u7A7A\u306E\u5834\u5408\u306F\u65BD\u8A2D\u304C\u306A\u3044\u5730\u56F3\u306B\u306A\u308A\u307E\u3059",required:!1,rules:[],id:"empty_input",disabled:!1,options:[{name:"\u7A7A",value:!0},{name:"\u5834\u6240",value:!1}],optionLabel:"name",optionValue:"value",placeholder:"\u7A7A\u30AB\u30C6\u30B4\u30EA\u30FC",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]}]},{classes:["flex","justify-space-between"],elements:[{component:null,name:"InputText",db_column_name:"name",type:"text",model:null,label:"\u30AB\u30C6\u30B4\u30EA\u30FC\u540D",hint:null,placeholder:"\u304A\u5E97",required:!0,id:"name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]},{classes:["flex","justify-space-between"],elements:[{component:null,name:"InputText",db_column_name:"color",type:"text",model:null,label:"\u30AB\u30C6\u30B4\u30EA\u30FC\u8272",hint:"*hex\u30B3\u30FC\u30C9\u3084RGB\u3092\u3054\u5165\u529B\u53EF",placeholder:"#6366F1",required:!0,id:"color_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]}]];const pe={id:"project_categories",class:"panel-board relative"},ce={class:"part-wrap"},me={class:"part-wrap part-end"},ve={class:"spreadsheet-wrapper overflow-x"},fe=z('<div class="sh-container ss-container"><div class="sheet-row sheet-row-header flex align-center"><div class="sheet-cell handle flex align-center"></div><div class="sheet-cell num flex align-center">\u9806\u756A</div><div class="sheet-cell value flex align-center">\u30AB\u30C6\u30B4\u30EA\u30FC\u540D</div></div></div>',1),_e=["onClick","onContextmenu"],ge=o("div",{class:"sheet-cell handle flex align-center justify-center grab"},[o("i",{class:"pi pi-bars"})],-1),be={class:"sheet-cell num flex align-center"},je={class:"sheet-cell value flex align-center"},he={class:"context block"},Ce={class:"button-wrapper flex justify-end"},Ue=O({setup(Ae){const V=J(),x=K(),{get:j,save:E}=oe(),{d:i,dr:r,images:_,data:d,useToggle:h}=ne(),{submit:B,submitRowReorder:k,remove:y}=re(),{rcm:q,rcmOpened:$,isRCOn:R}=ie(d),{payload:I,project:u,progress:P,onload:xe,content:p}=se(),g=c(),b=c(null),s=c([]),C=c(!1),m=c(!1);Q(()=>{var l;s.value=(l=u.value)==null?void 0:l.map_categories});function T(){V.push({name:"ProjectPlaces",params:{cid:x.params.cid,dynid:x.params.dynid}})}function S(){var l,e;C.value=!1,b.value={id:null,order_id:s.value?s.value.length+1:1,project:u.value?(l=u.value)==null?void 0:l.id:null,name:null,color:null,pin:null},g.value=A,h({method:"post",endpoints:["app/map_categories","project_details/"+((e=u.value)==null?void 0:e.id)],state:"project"})}function U(l){var e,a;C.value=!0,$.value||(_.value=l.pin?[{image:l.pin}]:[],g.value=A,b.value={id:null,order_id:l.order_id,project:u.value?(e=u.value)==null?void 0:e.id:null,name:null,color:null,pin:null},h({method:"patch",endpoints:["app/map_categories/"+l.id,"project_details/"+((a=u.value)==null?void 0:a.id)],state:"project"},l))}function N(l){var e;m.value=!0,I.value={method:"patch",endpoints:["app/map_categories/"+d.value.id,"project_details/"+((e=u.value)==null?void 0:e.id)],state:"salon"},B({pin:null},null,"object").then(()=>{m.value=!1,_.value=[]})}function H(){var l;m.value=!0,y("app/map_categories/"+((l=d.value)==null?void 0:l.id)).then(()=>{var e;j("project_details/"+((e=u.value)==null?void 0:e.id),"project").then(()=>{m.value=!1,r.value=!1,i.value=!1})})}const G=c([{label:"\u65B0\u898F\u30AB\u30C6\u30B4\u30EA\u30FC",command:()=>{var l,e;_.value=[],b.value={id:null,order_id:s.value?s.value.length+1:1,project:u.value?(l=u.value)==null?void 0:l.id:null,name:null,color:null,pin:null},g.value=A,h({method:"post",endpoints:["app/map_categories","project_details/"+((e=u.value)==null?void 0:e.id)],state:"project"})}},{label:"\u884C\u3092\u8907\u88FD\u3059\u308B",command:()=>{var e;p.value=!0;const l={id:null,order_id:s.value?s.value.length+1:1,project:u.value?(e=u.value)==null?void 0:e.id:null,name:d.value.name,color:d.value.color,pin:null};E("app/map_categories",l).then(()=>{var a;j("project_details/"+((a=u.value)==null?void 0:a.id),"project").then(()=>{p.value=!1})})}},{label:"\u884C\u3092\u524A\u9664\u3059\u308B",command:()=>{var l;p.value=!0,y("app/map_categories/"+((l=d.value)==null?void 0:l.id)).then(()=>{var e;j("project_details/"+((e=u.value)==null?void 0:e.id),"project").then(()=>{p.value=!1})})}}]);return W(()=>u.value,l=>{s.value=l==null?void 0:l.map_categories}),(l,e)=>(Y(),X("div",pe,[n(ee,{modelValue:t(p),"onUpdate:modelValue":e[0]||(e[0]=a=>v(p)?p.value=a:null)},null,8,["modelValue"]),n(le,{class:"justify-space-between"},{default:f(()=>[o("div",ce,[n(t(D),{type:"button",class:"submit-button",icon:"pi pi-plus","icon-pos":"left",label:"\u30AB\u30C6\u30B4\u30EA\u30FC\u3092\u8FFD\u52A0",onClick:e[1]||(e[1]=a=>S())})]),o("div",me,[n(t(D),{onClick:e[2]||(e[2]=a=>T()),type:"button",class:"tool-button",label:"\u65BD\u8A2D\u3078"})])]),_:1}),o("div",ve,[fe,n(t(M),{tag:"div",onEnd:e[3]||(e[3]=a=>t(k)({value:s.value},{method:"post",endpoints:["app/map_categories","project_details/"+t(u).id],state:"project"})),list:s.value,class:"sb-container ss-container",handle:".handle","item-key":"id"},{item:f(({element:a,index:L})=>[o("div",{onClick:F=>U(a),onContextmenu:F=>t(R)(F,a),class:"sheet-row flex align-center list-group-item relative pointer","aria-haspopup":"true","aria-controls":"plan_rc_menu"},[n(t(Z),{id:"rc_menu",ref_key:"rcm",ref:q,class:"rc has-final-action",model:G.value,popup:!0},null,8,["model"]),ge,o("div",be,w(L+1),1),o("div",je,[o("span",he,w(a.name),1)])],40,_e)]),_:1},8,["list"])]),n(ae,{modelValue:t(i),"onUpdate:modelValue":e[9]||(e[9]=a=>v(i)?i.value=a:null),title:"\u30AB\u30C6\u30B4\u30EA\u30FC\u30D5\u30A9\u30FC\u30E0"},{default:f(()=>[n(ue,{modelValue:t(i),"onUpdate:modelValue":e[4]||(e[4]=a=>v(i)?i.value=a:null),dr:t(r),"onUpdate:dr":e[5]||(e[5]=a=>v(r)?r.value=a:null),"close-after":"",topProgress:"",progress:t(P),form:g.value,data:t(d),loading:m.value,query:b.value,remove:C.value,submit:t(B)},{default:f(()=>[n(te,{containerId:"pin_input",images:t(_),remove:N},null,8,["images"])]),_:1},8,["modelValue","dr","progress","form","data","loading","query","remove","submit"]),n(de,{modelValue:t(r),"onUpdate:modelValue":e[8]||(e[8]=a=>v(r)?r.value=a:null)},{default:f(()=>[o("div",Ce,[o("button",{onClick:e[6]||(e[6]=a=>r.value=!1),class:"cancel"},"\u3044\u3044\u3048"),o("button",{onClick:e[7]||(e[7]=a=>H()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}});export{Ue as default};
