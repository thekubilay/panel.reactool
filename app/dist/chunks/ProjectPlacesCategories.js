import{d as O}from"./vuedraggable.umd.js";import{d as G,D as c,o as J,F as Q,b as z,k as n,u as t,l as v,w as f,e as s,a3 as K,I as W,J as X,a as Y,U as w,t as V}from"./vendor.js";import{s as Z}from"./menu.esm.js";import{a as ee,u as le,S as ae,_ as ue}from"./useFormRequestBuilder.js";import{_ as te}from"./BarTool.js";import{_ as se}from"./FormQuery.js";import{_ as oe}from"./ContextImagesThumbnailContainer.js";import{A as ne,u as ie}from"../main.js";import{u as re}from"./useRightClickHandler.js";import{_ as de}from"./DialogDelete.js";import"./overlayeventbus.esm.js";import"./Icon.js";const A=[[{classes:["flex","justify-space-between"],elements:[{component:null,name:"Dropdown",db_column_name:"empty",type:"text",model:!1,label:"\u30AB\u30C6\u30B4\u30EA\u30FC\u30BF\u30A4\u30D7",hint:"\u7A7A\u306E\u5834\u5408\u306F\u65BD\u8A2D\u304C\u306A\u3044\u5730\u56F3\u306B\u306A\u308A\u307E\u3059",required:!1,rules:[],id:"empty_input",disabled:!1,options:[{name:"\u7A7A",value:!0},{name:"\u5834\u6240",value:!1}],optionLabel:"name",optionValue:"value",placeholder:"\u7A7A\u30AB\u30C6\u30B4\u30EA\u30FC",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]}]},{classes:["flex","justify-space-between"],elements:[{component:null,name:"InputText",db_column_name:"name",type:"text",model:null,label:"\u30AB\u30C6\u30B4\u30EA\u30FC\u540D",hint:null,placeholder:"\u304A\u5E97",required:!0,id:"name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]},{classes:["flex","justify-space-between"],elements:[{component:null,name:"InputText",db_column_name:"color",type:"text",model:null,label:"\u30AB\u30C6\u30B4\u30EA\u30FC\u8272",hint:"*hex\u30B3\u30FC\u30C9\u3084RGB\u3092\u3054\u5165\u529B\u53EF",placeholder:"#6366F1",required:!0,id:"color_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]}]];const pe={id:"project_categories",class:"panel-board relative"},ce={class:"part-wrap"},me={class:"part-wrap part-end"},ve={class:"spreadsheet-wrapper overflow-x"},fe=K('<div class="sh-container ss-container"><div class="sheet-row sheet-row-header flex align-center"><div class="sheet-cell handle flex align-center"></div><div class="sheet-cell num flex align-center">\u9806\u756A</div><div class="sheet-cell value flex align-center">\u30AB\u30C6\u30B4\u30EA\u30FC\u540D</div></div></div>',1),_e=["onClick","onContextmenu"],ge=s("div",{class:"sheet-cell handle flex align-center justify-center grab"},[s("i",{class:"pi pi-bars"})],-1),be={class:"sheet-cell num flex align-center"},he={class:"sheet-cell value flex align-center"},je={class:"context block"},Ce={class:"button-wrapper flex justify-end"},Pe=G({setup(Ae){const k=W(),B=X(),{get:h,save:D}=ne(),{d:r,dr:i,images:_,data:d,useToggle:j}=ee(),{submit:x,submitRowReorder:E,remove:y}=le(),{rcm:$,rcmOpened:q,isRCOn:R}=re(d),{payload:I,project:u,progress:P,onload:Be,content:p}=ie(),g=c(),b=c(null),o=c([]),C=c(!1),m=c(!1);J(()=>{var l;o.value=(l=u.value)==null?void 0:l.map_categories});function T(){k.push({name:"ProjectPlaces",params:{cid:B.params.cid,dynid:B.params.dynid}})}function U(){var l,e;C.value=!1,b.value={id:null,order_id:o.value?o.value.length+1:1,project:u.value?(l=u.value)==null?void 0:l.id:null,name:null,color:null,pin:null},g.value=A,j({method:"post",endpoints:["app/map_categories","project_details/"+((e=u.value)==null?void 0:e.id)],state:"project"})}function S(l){var e,a;C.value=!0,q.value||(_.value=l.pin?[{image:l.pin}]:[],g.value=A,b.value={id:null,order_id:l.order_id,project:u.value?(e=u.value)==null?void 0:e.id:null,name:null,color:null,pin:null},j({method:"patch",endpoints:["app/map_categories/"+l.id,"project_details/"+((a=u.value)==null?void 0:a.id)],state:"project"},l))}function H(l){var e;m.value=!0,I.value={method:"patch",endpoints:["app/map_categories/"+d.value.id,"project_details/"+((e=u.value)==null?void 0:e.id)],state:"salon"},x({pin:null},null,"object").then(()=>{m.value=!1,_.value=[]})}function N(){var l;m.value=!0,y("app/map_categories/"+((l=d.value)==null?void 0:l.id)).then(()=>{var e;h("project_details/"+((e=u.value)==null?void 0:e.id),"project").then(()=>{m.value=!1,i.value=!1,r.value=!1})})}const L=c([{label:"\u65B0\u898F\u30AB\u30C6\u30B4\u30EA\u30FC",command:()=>{var l,e;_.value=[],b.value={id:null,order_id:o.value?o.value.length+1:1,project:u.value?(l=u.value)==null?void 0:l.id:null,name:null,color:null,pin:null},g.value=A,j({method:"post",endpoints:["app/map_categories","project_details/"+((e=u.value)==null?void 0:e.id)],state:"project"})}},{label:"\u884C\u3092\u8907\u88FD\u3059\u308B",command:()=>{var e;p.value=!0;const l={id:null,order_id:o.value?o.value.length+1:1,project:u.value?(e=u.value)==null?void 0:e.id:null,name:d.value.name,color:d.value.color,pin:null};D("app/map_categories",l).then(()=>{var a;h("project_details/"+((a=u.value)==null?void 0:a.id),"project").then(()=>{p.value=!1})})}},{label:"\u884C\u3092\u524A\u9664\u3059\u308B",command:()=>{var l;p.value=!0,y("app/map_categories/"+((l=d.value)==null?void 0:l.id)).then(()=>{var e;h("project_details/"+((e=u.value)==null?void 0:e.id),"project").then(()=>{p.value=!1})})}}]);return Q(()=>u.value,l=>{o.value=l==null?void 0:l.map_categories}),(l,e)=>(Y(),z("div",pe,[n(ae,{modelValue:t(p),"onUpdate:modelValue":e[0]||(e[0]=a=>v(p)?p.value=a:null)},null,8,["modelValue"]),n(te,{class:"justify-space-between"},{default:f(()=>[s("div",ce,[n(t(w),{type:"button",class:"submit-button",icon:"pi pi-plus","icon-pos":"left",label:"\u30AB\u30C6\u30B4\u30EA\u30FC\u3092\u8FFD\u52A0",onClick:e[1]||(e[1]=a=>U())})]),s("div",me,[n(t(w),{onClick:e[2]||(e[2]=a=>T()),type:"button",class:"tool-button",label:"\u65BD\u8A2D\u3078"})])]),_:1}),s("div",ve,[fe,n(t(O),{tag:"div",onEnd:e[3]||(e[3]=a=>t(E)({value:o.value},{method:"post",endpoints:["app/map_categories","project_details/"+t(u).id],state:"project"})),list:o.value,class:"sb-container ss-container",handle:".handle","item-key":"id"},{item:f(({element:a,index:M})=>[s("div",{onClick:F=>S(a),onContextmenu:F=>t(R)(F,a),class:"sheet-row flex align-center list-group-item relative pointer","aria-haspopup":"true","aria-controls":"plan_rc_menu"},[n(t(Z),{id:"rc_menu",ref_key:"rcm",ref:$,class:"rc has-final-action",model:L.value,popup:!0},null,8,["model"]),ge,s("div",be,V(M+1),1),s("div",he,[s("span",je,V(a.name),1)])],40,_e)]),_:1},8,["list"])]),n(ue,{modelValue:t(r),"onUpdate:modelValue":e[9]||(e[9]=a=>v(r)?r.value=a:null),title:"\u30AB\u30C6\u30B4\u30EA\u30FC\u30D5\u30A9\u30FC\u30E0"},{default:f(()=>[n(se,{modelValue:t(r),"onUpdate:modelValue":e[4]||(e[4]=a=>v(r)?r.value=a:null),dr:t(i),"onUpdate:dr":e[5]||(e[5]=a=>v(i)?i.value=a:null),"close-after":"",topProgress:"",progress:t(P),form:g.value,data:t(d),loading:m.value,query:b.value,remove:C.value,submit:t(x)},{default:f(()=>[n(oe,{containerId:"pin_input",images:t(_),remove:H},null,8,["images"])]),_:1},8,["modelValue","dr","progress","form","data","loading","query","remove","submit"]),n(de,{modelValue:t(i),"onUpdate:modelValue":e[8]||(e[8]=a=>v(i)?i.value=a:null)},{default:f(()=>[s("div",Ce,[s("button",{onClick:e[6]||(e[6]=a=>i.value=!1),class:"cancel"},"\u3044\u3044\u3048"),s("button",{onClick:e[7]||(e[7]=a=>N()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}});export{Pe as default};
