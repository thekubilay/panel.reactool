import{a as V,p as h,q as ee,t as I,b as l,v as i,f as d,x as e,y as j,z as s,A as b,B as se,C as k,D as te,E as J,o as ue,c as Q,F as ie,G as ce,H as S,w as g,I as R,J as L,K as E,T as q,r as O,e as M,L as z,M as de,g as pe}from"./vendor.js";import{_ as _e}from"./FormQuery.js";import{_ as le}from"./Icon.js";import{_ as ve}from"./ButtonDropdown.js";import{u as ae,S as me,o as oe,a as fe,_ as W}from"./useFormRequestBuilder.js";import X from"./password.esm.js";import{u as T,A as he}from"../main.js";import{f as we}from"./FormUserUpdate.js";import{u as ye}from"./useUtils.js";import"./plugin-vue_export-helper.js";import"./menu.esm.js";import"./overlayeventbus.esm.js";import"./rules.js";const ge={class:"form form-password-change"},be=["onSubmit"],Be={class:"row column-1 flex justify-space-between"},Ce={class:"flex-column column-2-space"},xe=e("span",{class:"label flex"},[k("\u904E\u53BB\u306E\u30D1\u30B9\u30EF\u30FC\u30C9"),e("span",{class:"required flex align-start"},"*\u5FC5\u9808")],-1),Fe={key:0,class:"invalid block"},$e={class:"row column-1 flex justify-space-between"},ke={class:"flex-column column-2-space"},Ee=e("span",{class:"label flex"},[k("\u65B0\u898F\u30D1\u30B9\u30EF\u30FC\u30C9"),e("span",{class:"required flex align-start"},"*\u5FC5\u9808")],-1),De={key:0,class:"invalid block"},je={class:"row column-1 flex justify-space-between"},Ae={class:"flex-column column-2-space"},Ve=e("span",{class:"label flex"},[k("\u65B0\u898F\u30D1\u30B9\u30EF\u30FC\u30C9\u78BA\u8A8D"),e("span",{class:"required flex align-start"},"*\u5FC5\u9808")],-1),Te={key:0,class:"invalid block"},Ue={class:"action-wrapper flex align-center"},Pe=V({props:{modelValue:Boolean},emits:["update:modelValue"],setup(A,{emit:B}){const{submit:x}=ae(),{payload:F,user:C}=T(),_=h(!1),t=h([]),o=ee({old_password:null,new_password:null,password_confirm:null});function w(){t.value=[],F.value={method:"patch",endpoints:["change_password",""],state:""},Object.keys(o).forEach(r=>{o[r]||t.value.push(r)}),o.new_password!==o.password_confirm&&t.value.push("new_password","password_confirm"),t.value.length?_.value=!1:x(o,[[]]).then(r=>{r.code===200?window.location.href="http://127.0.0.1:8000/accounts/login/":t.value.push("old_password"),_.value=!1})}return I(()=>o.old_password,r=>{t.value=t.value.filter(u=>u!=="old_password")}),I(()=>o.new_password,r=>{t.value=t.value.filter(u=>u!=="new_password")}),I(()=>o.password_confirm,r=>{t.value=t.value.filter(u=>u!=="password_confirm")}),(r,u)=>(l(),i("div",ge,[d(me,{modelValue:_.value,"onUpdate:modelValue":u[0]||(u[0]=p=>_.value=p),text:""},null,8,["modelValue"]),e("form",{action:"",onSubmit:se(p=>!1,["prevent"])},[e("div",Be,[e("div",Ce,[xe,d(s(X),{class:j({error:t.value.includes("old_password")}),modelValue:s(o).old_password,"onUpdate:modelValue":u[1]||(u[1]=p=>s(o).old_password=p),toggleMask:"",feedback:!1},null,8,["class","modelValue"]),t.value.includes("old_password")?(l(),i("span",Fe,"\u904E\u53BB\u306E\u30D1\u30B9\u30EF\u30FC\u30C9\u3092\u6B63\u3057\u304F\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044")):b("",!0)])]),e("div",$e,[e("div",ke,[Ee,d(s(X),{class:j({error:t.value.includes("new_password")}),modelValue:s(o).new_password,"onUpdate:modelValue":u[2]||(u[2]=p=>s(o).new_password=p),toggleMask:"",appendTo:"self"},null,8,["class","modelValue"]),t.value.includes("new_password")?(l(),i("span",De,"\u65B0\u898F\u306E\u30D1\u30B9\u30EF\u30FC\u30C9\u3092\u6B63\u3057\u304F\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044")):b("",!0)])]),e("div",je,[e("div",Ae,[Ve,d(s(X),{class:j({error:t.value.includes("password_confirm")}),modelValue:s(o).password_confirm,"onUpdate:modelValue":u[3]||(u[3]=p=>s(o).password_confirm=p),toggleMask:"",feedback:!1},null,8,["class","modelValue"]),t.value.includes("password_confirm")?(l(),i("span",Te,"\u65B0\u898F\u78BA\u8A8D\u306E\u30D1\u30B9\u30EF\u30FC\u30C9\u3092\u6B63\u3057\u304F\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044")):b("",!0)])]),e("div",Ue,[e("button",{onClick:u[4]||(u[4]=p=>B("update:modelValue",!1)),class:"flex align-center justify-center cancel"},"\u4E2D\u6B62"),e("button",{onClick:u[5]||(u[5]=p=>w()),class:"flex align-center justify-center submit-or-next"},"\u767B\u9332")])],40,be)]))}});const Se={class:"app-filter-wrapper relative"},qe={class:"input-wrapper relative"},Me=e("i",{class:"pi pi-search"},null,-1),Ne={class:"dropdown-wrapper"},He={key:0,class:"dropdown"},Ie={key:0,class:"empty-text flex-column align-center justify-center"},Re=e("span",{class:"text block"},"\u7D50\u679C\u306A\u3057",-1),Le=["onClick"],Oe={class:"text block"},ze=k(),Ke=e("span",{class:"arrow-wrap flex justify-center"},[e("i",{class:"pi pi-arrow-right flex"})],-1),Ge=V({setup(A){const{projects:B,salons:x}=T(),F=te(),C=J(),_=h(!1),t=h(),o=h(""),w=h([]),r=h([]);ue(()=>{var v;t.value=document.getElementById("afi"),(v=t.value)==null||v.addEventListener("keydown",p),x.value.forEach(a=>{const m={id:a.id,path:null,name:a.name.replaceAll("<br>",""),type:"salon"};w.value.push(m)}),B.value.forEach(a=>{const m={id:a.id,path:null,name:a.name.replaceAll("<br>",""),type:"project"};w.value.push(m)})});const u=Q({set(v){r.value=w.value.filter(a=>a.name.match(v))},get(){return o.value}});function p(v){v&&v.keyCode===27&&(_.value=!1)}function U(v){v.type==="salon"?F.push({name:"SalonProjects",params:{cid:C.params.cid,dynid:v.id}}).then(()=>{_.value=!1,o.value=""}):v.type==="project"&&F.push({name:"ProjectPlaces",params:{cid:C.params.cid,dynid:v.id}}).then(()=>{_.value=!1,o.value=""})}return oe(t,v=>{_.value=!1}),(v,a)=>(l(),i("div",Se,[e("div",qe,[Me,ie(e("input",{id:"afi",onClick:a[0]||(a[0]=m=>_.value=!_.value),type:"text","onUpdate:modelValue":a[1]||(a[1]=m=>S(u)?u.value=m:null),placeholder:"\u691C\u7D22"},null,512),[[ce,s(u)]])]),e("div",Ne,[d(q,{name:"slideDown"},{default:g(()=>[_.value?(l(),i("ul",He,[r.value.length?b("",!0):(l(),i("li",Ie,[d(le,{svg:"empty",width:"24px"}),Re])),(l(!0),i(R,null,L(r.value,(m,f)=>(l(),i("li",{key:f,onClick:N=>U(m),class:"dropdown-item flex align-center pointer"},[e("span",Oe,E(m.name),1),ze,Ke],8,Le))),128))])):b("",!0)]),_:1})])]))}});const Je={id:"bar_app",class:"container flex justify-space-between"},Qe={class:"bar-app-brand"},We={class:"bar-app-global-filter flex align-center"},Xe={class:"bar-app-global-actions flex justify-end"},Ye=e("i",{class:"pi pi-question-circle"},null,-1),Ze={key:0,class:"badge flex align-center justify-center text-center"},es=e("div",{class:"header flex align-center"},[e("h3",{class:"ht"},"\u901A\u77E5")],-1),ss={class:"body relative"},ts=["onClick"],us={class:"content"},ls={class:"date"},as={class:"title"},os={class:"content"},ns={key:0,class:"unseen block relative"},rs=e("span",{class:"badge"},null,-1),is=[rs],cs=["onClick"],ds=e("span",{class:"remove flex align-center justify-center"},[e("i",{class:"pi pi-trash"})],-1),ps=[ds],_s={key:0,class:"empty flex align-center justify-center"},vs={class:"d-content-header flex align-center justify-end"},ms={class:"d-content-body"},fs=["innerHTML"],hs=V({setup(A){const B=J(),x=te(),{get:F}=he(),{submit:C,remove:_}=ae(),{user:t,onload:o,progress:w,payload:r}=T(),{d:u,d2:p,useToggle:U}=fe(),v=ee({id:null,first_name:null,last_name:null,email:null,username:null}),a=h(0),m=h(!1),f=h(0),N=h(),K=h(!1),P=h(null),G=h([{label:"\u30D7\u30ED\u30D5\u30A3\u30FC\u30EB",icon:"pi pi-user",command:()=>{var y;U({method:"patch",endpoints:["users/"+((y=t.value)==null?void 0:y.id),"users/current"],state:"user"})}},{label:"\u30D1\u30B9\u30EF\u30FC\u30C9\u66F4\u65B0",icon:"pi pi-lock",command:()=>{p.value=!0}},{label:"\u7BA1\u7406\u30D1\u30CD\u30EB",icon:"pi pi-cog",command:()=>{x.push({name:"Admin"})}},{label:"\u30ED\u30B0\u30A2\u30A6\u30C8",icon:"pi pi-sign-out",command:()=>location.href="https://test-panel.reactool.jp/accounts/logout/"}]),ne=y=>{P.value=y,K.value=!0,m.value=!1,y.seen||(r.value={method:"patch",endpoints:["user-news/"+y.id,"users/current"],state:"user"},C({seen:!0},null,"object").then(()=>{setTimeout(()=>{var n;a.value=((n=t.value)==null?void 0:n.news.filter($=>!$.seen).length)||0},1e3)}))},re=y=>{_("user-news/"+y).then(()=>{F("users/current","user").then(n=>{var $;a.value=(($=n.news)==null?void 0:$.filter(D=>!D.seen).length)||0})})};return ue(()=>{var y,n,$;a.value=((y=t.value)==null?void 0:y.news.filter(D=>!D.seen).length)||0,!((n=t.value)==null?void 0:n.is_superuser)&&!(($=t.value)==null?void 0:$.is_staff)&&(G.value=G.value.filter(D=>D.label!=="\u7BA1\u7406\u30D1\u30CD\u30EB"))}),oe(N,y=>{m.value=!1}),I(()=>f.value,y=>{var n;y===0?r.value={method:"patch",endpoints:["users/"+((n=t.value)==null?void 0:n.id),"users/current"],state:"user"}:r.value={method:"patch",endpoints:["users","users/current"],state:"user"}}),(y,n)=>{var D,Y;const $=O("router-link");return l(),i("header",Je,[e("div",Qe,[d($,{class:"brand flex align-center",to:{name:"Dashboard",params:{cid:s(t).company}}},{default:g(()=>[d(le,{svg:"reactool",width:"100px"})]),_:1},8,["to"])]),e("div",We,[d(Ge)]),e("div",Xe,[s(t).is_superuser?(l(),M($,{key:0,class:"tutorials flex align-center justify-center",to:{name:"BoardTutorials",params:{cid:s(B).params.cid}}},{default:g(()=>[Ye]),_:1},8,["to"])):b("",!0),e("button",{onClick:n[0]||(n[0]=c=>m.value=!m.value),class:"news-button flex align-center justify-center relative"},[a.value>0?(l(),i("span",Ze,E(a.value),1)):b("",!0),e("i",{class:j(["pi pi-bell",{active:a.value>0}])},null,2)]),d(q,{name:"fade"},{default:g(()=>[m.value?(l(),i("div",{key:0,class:"news",ref_key:"newsOutside",ref:N},[es,e("div",ss,[(l(!0),i(R,null,L(s(t).news,c=>(l(),i("div",{class:"row flex align-center",onClick:H=>ne(c)},[e("div",us,[e("span",ls,E(c.created_at.substring(0,10)),1),e("h4",as,E(c.title),1),e("div",os,E(c.content.replace(/<[^>]*>?/gm,"").substring(0,50)),1)]),c.seen?b("",!0):(l(),i("div",ns,is)),c.seen?(l(),i("div",{key:1,onClick:se(H=>re(c.id),["stop"]),class:"unseen flex align-center justify-center relative"},ps,8,cs)):b("",!0)],8,ts))),256)),s(t).news.length?b("",!0):(l(),i("div",_s,"\u7A7A"))])],512)):b("",!0)]),_:1}),d(ve,{id:"user_menu",final:"",label:(D=s(t))==null?void 0:D.username,items:G.value},null,8,["label","items"])]),d(W,{modelValue:s(u),"onUpdate:modelValue":n[3]||(n[3]=c=>S(u)?u.value=c:null),title:(Y=s(t))==null?void 0:Y.username},{default:g(()=>[d(_e,{modelValue:s(u),"onUpdate:modelValue":n[1]||(n[1]=c=>S(u)?u.value=c:null),"active-tab":f.value,"onUpdate:active-tab":n[2]||(n[2]=c=>f.value=c),"close-after":"",topProgress:"",progress:s(w),form:s(we),onload:s(o),data:s(t),query:s(v),submit:s(C)},null,8,["modelValue","active-tab","progress","form","onload","data","query","submit"])]),_:1},8,["modelValue","title"]),d(W,{modelValue:s(p),"onUpdate:modelValue":n[5]||(n[5]=c=>S(p)?p.value=c:null),title:"\u30D1\u30B9\u30EF\u30FC\u30C9\u66F4\u65B0"},{default:g(()=>[d(Pe,{modelValue:s(p),"onUpdate:modelValue":n[4]||(n[4]=c=>S(p)?p.value=c:null)},null,8,["modelValue"])]),_:1},8,["modelValue"]),d(W,{modelValue:K.value,"onUpdate:modelValue":n[6]||(n[6]=c=>K.value=c),title:P.value&&P.value.title,overflow:""},{default:g(()=>{var c,H,Z;return[e("div",vs,E((H=(c=P.value)==null?void 0:c.created_at)==null?void 0:H.substring(0,10)),1),e("div",ms,[e("div",{innerHTML:(Z=P.value)==null?void 0:Z.content},null,8,fs)])]}),_:1},8,["modelValue","title"])])}}});const ws={id:"sidebar_app"},ys={class:"ctr2 overflow-y"},gs=k(" \u30B5\u30ED\u30F3 "),bs={key:0,class:"body custom-sb custom-sb-invert"},Bs=k(" \u30D7\u30ED\u30B8\u30A7\u30AF\u30C8 "),Cs={key:0,class:"body custom-sb custom-sb-invert"},xs=V({setup(A){const{salons:B,projects:x,project:F,content:C}=T(),{setColorById:_,groupBy:t}=ye(),o=J(),w=h(!1),r=h(!0),u=Q(()=>w.value?w.value&&!r.value?"auto":"50%":"40px"),p=Q(()=>r.value?r.value&&!w.value?"calc(100% - 40px)":"50%":"40px"),U=(v,a)=>"ProjectPlaces";return(v,a)=>{const m=O("router-link");return l(),i("div",ws,[e("nav",null,[e("div",ys,[e("div",{class:"part part1",style:z({height:s(u)})},[e("div",{onClick:a[0]||(a[0]=f=>w.value=!w.value),class:"header pointer"},[gs,e("i",{style:{top:"1px"},class:j("pi pi-angle-"+(w.value?"up":"down"))},null,2)]),d(q,{name:"slideDown"},{default:g(()=>[w.value?(l(),i("div",bs,[(l(!0),i(R,null,L(s(B),f=>(l(),M(m,{key:f.id,to:{name:"SalonProjects",params:{cid:s(o).params.cid,dynid:f.id}},class:"nav-item flex align-center","active-class":"active"},{default:g(()=>[e("span",{class:"color block",style:z({backgroundColor:s(_)(f.id)})},null,4),e("div",null,E(f.name),1)]),_:2},1032,["to"]))),128))])):b("",!0)]),_:1})],4),e("div",{class:"part part2",style:z({height:s(p)})},[e("div",{onClick:a[1]||(a[1]=f=>r.value=!r.value),class:"header pointer"},[Bs,e("i",{style:{top:"1px"},class:j("pi pi-angle-"+(r.value?"up":"down"))},null,2)]),d(q,{name:"slideDown"},{default:g(()=>[r.value?(l(),i("div",Cs,[(l(!0),i(R,null,L(s(x),f=>(l(),M(m,{key:f.id,onClick:a[2]||(a[2]=N=>C.value=!0),to:{name:U(f.id,s(o).name+""),params:{cid:s(o).params.cid,dynid:f.id}},class:"nav-item flex align-center","active-class":"active"},{default:g(()=>[e("span",{class:"color block",style:z({backgroundColor:s(_)(f.id)})},null,4),e("div",null,E(f.name.replaceAll("<br>","")),1)]),_:2},1032,["to"]))),128))])):b("",!0)]),_:1})],4)])])])}}});const Fs={class:"notify-top-bar flex align-center relative"},$s=e("div",{class:"icon flex align-center"},"\u{1F4CB}",-1),ks={class:"content"},Es={class:"title"},Ds=e("i",{class:"pi pi-times"},null,-1),js=[Ds],As=V({props:{modelValue:Boolean,title:{type:String,default:"\u30A2\u30C3\u30D7\u30FC\u30C7\u30FC\u30C8"}},setup(A){const{notifyTopBar:B}=T(),x=()=>{B.value=!1};return(F,C)=>(l(),i("div",Fs,[$s,e("div",ks,[e("h3",Es,E(A.title),1),de(F.$slots,"default")]),e("button",{class:"close",onClick:C[0]||(C[0]=_=>x())},js)]))}}),Vs={class:"mrw"},Ts={class:"context"},Us=k(" \u30EA\u30A2\u30AF\u30C4\u30FC\u30EB\u306E\u65B0\u3057\u3044\u30D0\u30FC\u30B8\u30E7\u30F3\u3092\u3054\u5229\u7528\u3044\u305F\u3060\u3051\u307E\u3059\u3002\u3088\u308A\u30D1\u30EF\u30D5\u30EB\u3067\u9AD8\u901F\u306B\u306A\u308A\u3001\u5B89\u5168\u6027\u3084\u4F7F\u3044\u3084\u3059\u3055\u3092\u5411\u4E0A\u3057\u3066\u3044\u307E\u3059\u3002"),Ps=e("br",null,null,-1),Ss=k(" \u30D7\u30ED\u30B8\u30A7\u30AF\u30C8\u3054\u3068\u306B\u3044\u3064\u3067\u3082\u65B0\u30D0\u30FC\u30B8\u30E7\u30F3\uFF08v1.5\uFF09\u306B\u5207\u308A\u66FF\u3048\u308B\u4E8B\u304C\u3067\u304D\u307E\u3059\u3002 "),qs=k("\u30C4\u30FC\u30C8\u30FC\u30EA\u30A2\u30EB\u3092\u898B\u308B\uFF01"),Ms={class:"column-1 flex"},Ys=V({setup(A){const{notifyTopBar:B,user:x}=T();return(F,C)=>{const _=O("router-link"),t=O("router-view");return l(),i("div",Vs,[s(B)?(l(),M(As,{key:0},{default:g(()=>[e("p",Ts,[Us,Ps,Ss,d(_,{to:{name:"BoardTutorials",params:{cid:s(x).company}}},{default:g(()=>[qs]),_:1},8,["to"])])]),_:1})):b("",!0),d(hs,{class:"bar-board container flex align-center"}),e("main",{class:j(["flex column-1",{"notify-on":s(B)}])},[e("div",Ms,[d(xs),d(t,{class:"contents column-1"},{default:g(({Component:o})=>[d(q,{name:"fade",mode:"out-in"},{default:g(()=>[(l(),M(pe(o)))]),_:2},1024)]),_:1})])],2)])}}});export{Ys as default};
