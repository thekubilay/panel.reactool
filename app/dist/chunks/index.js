import{a as U,p as f,q as se,t as R,b as l,v as n,f as c,x as e,y as A,z as t,A as y,B as te,C as E,D as ue,E as J,o as Q,c as W,F as ie,G as ce,H as M,w as g,I as L,J as O,K as j,T as N,r as z,e as H,L as de,M as K,N as pe,g as _e}from"./vendor.js";import{_ as me}from"./FormQuery.js";import{_ as le}from"./Icon.js";import{_ as ve}from"./ButtonDropdown.js";import{u as ae,o as ne,a as fe,_ as X}from"./useFormRequestBuilder.js";import Y from"./password.esm.js";import{S as he}from"./Spinner.js";import{u as P,A as we}from"../main.js";import{f as ye}from"./FormUserUpdate.js";import{u as ge}from"./useUtils.js";import"./plugin-vue_export-helper.js";import"./menu.esm.js";import"./overlayeventbus.esm.js";import"./rules.js";const be={class:"form form-password-change"},Be=["onSubmit"],Ce={class:"row column-1 flex justify-space-between"},xe={class:"flex-column column-2-space"},Fe=e("span",{class:"label flex"},[E("\u904E\u53BB\u306E\u30D1\u30B9\u30EF\u30FC\u30C9"),e("span",{class:"required flex align-start"},"*\u5FC5\u9808")],-1),$e={key:0,class:"invalid block"},ke={class:"row column-1 flex justify-space-between"},Ee={class:"flex-column column-2-space"},je=e("span",{class:"label flex"},[E("\u65B0\u898F\u30D1\u30B9\u30EF\u30FC\u30C9"),e("span",{class:"required flex align-start"},"*\u5FC5\u9808")],-1),De={key:0,class:"invalid block"},Ae={class:"row column-1 flex justify-space-between"},Ve={class:"flex-column column-2-space"},Te=e("span",{class:"label flex"},[E("\u65B0\u898F\u30D1\u30B9\u30EF\u30FC\u30C9\u78BA\u8A8D"),e("span",{class:"required flex align-start"},"*\u5FC5\u9808")],-1),Ue={key:0,class:"invalid block"},Pe={class:"action-wrapper flex align-center"},Se=U({props:{modelValue:Boolean},emits:["update:modelValue"],setup(V,{emit:b}){const{submit:B}=ae(),{payload:C,user:x}=P(),_=f(!1),s=f([]),r=se({old_password:null,new_password:null,password_confirm:null});function F(){s.value=[],C.value={method:"patch",endpoints:["change_password",""],state:""},Object.keys(r).forEach(o=>{r[o]||s.value.push(o)}),r.new_password!==r.password_confirm&&s.value.push("new_password","password_confirm"),s.value.length?_.value=!1:B(r,[[]]).then(o=>{o.code===200?window.location.href="http://127.0.0.1:8000/accounts/login/":s.value.push("old_password"),_.value=!1})}return R(()=>r.old_password,o=>{s.value=s.value.filter(u=>u!=="old_password")}),R(()=>r.new_password,o=>{s.value=s.value.filter(u=>u!=="new_password")}),R(()=>r.password_confirm,o=>{s.value=s.value.filter(u=>u!=="password_confirm")}),(o,u)=>(l(),n("div",be,[c(he,{modelValue:_.value,"onUpdate:modelValue":u[0]||(u[0]=d=>_.value=d),text:""},null,8,["modelValue"]),e("form",{action:"",onSubmit:te(d=>!1,["prevent"])},[e("div",Ce,[e("div",xe,[Fe,c(t(Y),{class:A({error:s.value.includes("old_password")}),modelValue:t(r).old_password,"onUpdate:modelValue":u[1]||(u[1]=d=>t(r).old_password=d),toggleMask:"",feedback:!1},null,8,["class","modelValue"]),s.value.includes("old_password")?(l(),n("span",$e,"\u904E\u53BB\u306E\u30D1\u30B9\u30EF\u30FC\u30C9\u3092\u6B63\u3057\u304F\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044")):y("",!0)])]),e("div",ke,[e("div",Ee,[je,c(t(Y),{class:A({error:s.value.includes("new_password")}),modelValue:t(r).new_password,"onUpdate:modelValue":u[2]||(u[2]=d=>t(r).new_password=d),toggleMask:"",appendTo:"self"},null,8,["class","modelValue"]),s.value.includes("new_password")?(l(),n("span",De,"\u65B0\u898F\u306E\u30D1\u30B9\u30EF\u30FC\u30C9\u3092\u6B63\u3057\u304F\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044")):y("",!0)])]),e("div",Ae,[e("div",Ve,[Te,c(t(Y),{class:A({error:s.value.includes("password_confirm")}),modelValue:t(r).password_confirm,"onUpdate:modelValue":u[3]||(u[3]=d=>t(r).password_confirm=d),toggleMask:"",feedback:!1},null,8,["class","modelValue"]),s.value.includes("password_confirm")?(l(),n("span",Ue,"\u65B0\u898F\u78BA\u8A8D\u306E\u30D1\u30B9\u30EF\u30FC\u30C9\u3092\u6B63\u3057\u304F\u5165\u529B\u3057\u3066\u304F\u3060\u3055\u3044")):y("",!0)])]),e("div",Pe,[e("button",{onClick:u[4]||(u[4]=d=>b("update:modelValue",!1)),class:"flex align-center justify-center cancel"},"\u4E2D\u6B62"),e("button",{onClick:u[5]||(u[5]=d=>F()),class:"flex align-center justify-center submit-or-next"},"\u767B\u9332")])],40,Be)]))}});const qe={class:"app-filter-wrapper relative"},Me={class:"input-wrapper relative"},Ne=e("i",{class:"pi pi-search"},null,-1),He={class:"dropdown-wrapper"},Ie={key:0,class:"dropdown"},Re={key:0,class:"empty-text flex-column align-center justify-center"},Le=e("span",{class:"text block"},"\u7D50\u679C\u306A\u3057",-1),Oe=["onClick"],ze={class:"text block"},Ke=E(),Ge=e("span",{class:"arrow-wrap flex justify-center"},[e("i",{class:"pi pi-arrow-right flex"})],-1),Je=U({setup(V){const{projects:b,salons:B}=P(),C=ue(),x=J(),_=f(!1),s=f(),r=f(""),F=f([]),o=f([]);Q(()=>{var m;s.value=document.getElementById("afi"),(m=s.value)==null||m.addEventListener("keydown",d),B.value.forEach(p=>{const v={id:p.id,path:null,name:p.name.replaceAll("<br>",""),type:"salon"};F.value.push(v)}),b.value.forEach(p=>{const v={id:p.id,path:null,name:p.name.replaceAll("<br>",""),type:"project"};F.value.push(v)})});const u=W({set(m){o.value=F.value.filter(p=>p.name.match(m))},get(){return r.value}});function d(m){m&&m.keyCode===27&&(_.value=!1)}function S(m){m.type==="salon"?C.push({name:"SalonProjects",params:{cid:x.params.cid,dynid:m.id}}).then(()=>{_.value=!1,r.value=""}):m.type==="project"&&C.push({name:"ProjectPlaces",params:{cid:x.params.cid,dynid:m.id}}).then(()=>{_.value=!1,r.value=""})}return ne(s,m=>{_.value=!1}),(m,p)=>(l(),n("div",qe,[e("div",Me,[Ne,ie(e("input",{id:"afi",onClick:p[0]||(p[0]=v=>_.value=!_.value),type:"text","onUpdate:modelValue":p[1]||(p[1]=v=>M(u)?u.value=v:null),placeholder:"\u691C\u7D22"},null,512),[[ce,t(u)]])]),e("div",He,[c(N,{name:"slideDown"},{default:g(()=>[_.value?(l(),n("ul",Ie,[o.value.length?y("",!0):(l(),n("li",Re,[c(le,{svg:"empty",width:"24px"}),Le])),(l(!0),n(L,null,O(o.value,(v,$)=>(l(),n("li",{key:$,onClick:T=>S(v),class:"dropdown-item flex align-center pointer"},[e("span",ze,j(v.name),1),Ke,Ge],8,Oe))),128))])):y("",!0)]),_:1})])]))}});const Qe={id:"bar_app",class:"container flex justify-space-between"},We={class:"bar-app-brand"},Xe={class:"bar-app-global-filter flex align-center"},Ye={class:"bar-app-global-actions flex justify-end"},Ze=e("i",{class:"pi pi-question-circle"},null,-1),es={key:0,class:"badge flex align-center justify-center text-center"},ss=e("div",{class:"header flex align-center"},[e("h3",{class:"ht"},"\u901A\u77E5")],-1),ts={class:"body relative"},us=["onClick"],ls={class:"content"},as={class:"date"},ns={class:"title"},os={class:"content"},rs={key:0,class:"unseen block relative"},is=e("span",{class:"badge"},null,-1),cs=[is],ds=["onClick"],ps=e("span",{class:"remove flex align-center justify-center"},[e("i",{class:"pi pi-trash"})],-1),_s=[ps],ms={key:0,class:"empty flex align-center justify-center"},vs={class:"d-content-header flex align-center justify-end"},fs={class:"d-content-body"},hs=["innerHTML"],ws=U({setup(V){const b=J(),B=ue(),{get:C}=we(),{submit:x,remove:_}=ae(),{user:s,onload:r,progress:F,payload:o}=P(),{d:u,d2:d,useToggle:S}=fe(),m=se({id:null,first_name:null,last_name:null,email:null,username:null}),p=f(0),v=f(!1),$=f(0),T=f(),h=f(!1),q=f(null),G=f([{label:"\u30D7\u30ED\u30D5\u30A3\u30FC\u30EB",icon:"pi pi-user",command:()=>{var w;S({method:"patch",endpoints:["users/"+((w=s.value)==null?void 0:w.id),"users/current"],state:"user"})}},{label:"\u30D1\u30B9\u30EF\u30FC\u30C9\u66F4\u65B0",icon:"pi pi-lock",command:()=>{d.value=!0}},{label:"\u7BA1\u7406\u30D1\u30CD\u30EB",icon:"pi pi-cog",command:()=>{B.push({name:"Admin"})}},{label:"\u30ED\u30B0\u30A2\u30A6\u30C8",icon:"pi pi-sign-out",command:()=>location.href="https://test-panel.reactool.jp/accounts/logout/"}]),oe=w=>{q.value=w,h.value=!0,v.value=!1,w.seen||(o.value={method:"patch",endpoints:["user-news/"+w.id,"users/current"],state:"user"},x({seen:!0},null,"object").then(()=>{setTimeout(()=>{var a;p.value=((a=s.value)==null?void 0:a.news.filter(k=>!k.seen).length)||0},1e3)}))},re=w=>{_("user-news/"+w).then(()=>{C("users/current","user").then(a=>{var k;p.value=((k=a.news)==null?void 0:k.filter(D=>!D.seen).length)||0})})};return Q(()=>{var w,a,k;p.value=((w=s.value)==null?void 0:w.news.filter(D=>!D.seen).length)||0,!((a=s.value)==null?void 0:a.is_superuser)&&!((k=s.value)==null?void 0:k.is_staff)&&(G.value=G.value.filter(D=>D.label!=="\u7BA1\u7406\u30D1\u30CD\u30EB"))}),ne(T,w=>{v.value=!1}),R(()=>$.value,w=>{var a;w===0?o.value={method:"patch",endpoints:["users/"+((a=s.value)==null?void 0:a.id),"users/current"],state:"user"}:o.value={method:"patch",endpoints:["users","users/current"],state:"user"}}),(w,a)=>{var D,Z;const k=z("router-link");return l(),n("header",Qe,[e("div",We,[c(k,{class:"brand flex align-center",to:{name:"Dashboard",params:{cid:t(s).company}}},{default:g(()=>[c(le,{svg:"reactool",width:"100px"})]),_:1},8,["to"])]),e("div",Xe,[c(Je)]),e("div",Ye,[t(s).is_superuser?(l(),H(k,{key:0,class:"tutorials flex align-center justify-center",to:{name:"BoardTutorials",params:{cid:t(b).params.cid}}},{default:g(()=>[Ze]),_:1},8,["to"])):y("",!0),e("button",{onClick:a[0]||(a[0]=i=>v.value=!v.value),class:"news-button flex align-center justify-center relative"},[p.value>0?(l(),n("span",es,j(p.value),1)):y("",!0),e("i",{class:A(["pi pi-bell",{active:p.value>0}])},null,2)]),c(N,{name:"fade"},{default:g(()=>[v.value?(l(),n("div",{key:0,class:"news",ref_key:"newsOutside",ref:T},[ss,e("div",ts,[(l(!0),n(L,null,O(t(s).news,i=>(l(),n("div",{class:"row flex align-center",onClick:I=>oe(i)},[e("div",ls,[e("span",as,j(i.created_at.substring(0,10)),1),e("h4",ns,j(i.title),1),e("div",os,j(i.content.replace(/<[^>]*>?/gm,"").substring(0,50)),1)]),i.seen?y("",!0):(l(),n("div",rs,cs)),i.seen?(l(),n("div",{key:1,onClick:te(I=>re(i.id),["stop"]),class:"unseen flex align-center justify-center relative"},_s,8,ds)):y("",!0)],8,us))),256)),t(s).news.length?y("",!0):(l(),n("div",ms,"\u7A7A"))])],512)):y("",!0)]),_:1}),c(ve,{id:"user_menu",final:"",label:(D=t(s))==null?void 0:D.username,items:G.value},null,8,["label","items"])]),c(X,{modelValue:t(u),"onUpdate:modelValue":a[3]||(a[3]=i=>M(u)?u.value=i:null),title:(Z=t(s))==null?void 0:Z.username},{default:g(()=>[c(me,{modelValue:t(u),"onUpdate:modelValue":a[1]||(a[1]=i=>M(u)?u.value=i:null),"active-tab":$.value,"onUpdate:active-tab":a[2]||(a[2]=i=>$.value=i),"close-after":"",topProgress:"",progress:t(F),form:t(ye),onload:t(r),data:t(s),query:t(m),submit:t(x)},null,8,["modelValue","active-tab","progress","form","onload","data","query","submit"])]),_:1},8,["modelValue","title"]),c(X,{modelValue:t(d),"onUpdate:modelValue":a[5]||(a[5]=i=>M(d)?d.value=i:null),title:"\u30D1\u30B9\u30EF\u30FC\u30C9\u66F4\u65B0"},{default:g(()=>[c(Se,{modelValue:t(d),"onUpdate:modelValue":a[4]||(a[4]=i=>M(d)?d.value=i:null)},null,8,["modelValue"])]),_:1},8,["modelValue"]),c(X,{modelValue:h.value,"onUpdate:modelValue":a[6]||(a[6]=i=>h.value=i),title:q.value&&q.value.title,overflow:""},{default:g(()=>{var i,I,ee;return[e("div",vs,j((I=(i=q.value)==null?void 0:i.created_at)==null?void 0:I.substring(0,10)),1),e("div",fs,[e("div",{innerHTML:(ee=q.value)==null?void 0:ee.content},null,8,hs)])]}),_:1},8,["modelValue","title"])])}}});const ys={id:"sidebar_app"},gs={class:"ctr2 overflow-y"},bs=E(" \u30B5\u30ED\u30F3 "),Bs={key:0,class:"body custom-sb custom-sb-invert"},Cs=E(" \u30D7\u30ED\u30B8\u30A7\u30AF\u30C8 "),xs={key:0,class:"body custom-sb custom-sb-invert"},Fs=U({setup(V){const{user:b,salons:B,projects:C,project:x,content:_}=P(),{setColorById:s,groupBy:r}=ge(),F=J(),o=f(!1),u=f(!0),d=f(),S=W(()=>o.value?o.value&&!u.value?"auto":"50%":"40px"),m=W(()=>u.value?u.value&&!o.value?"calc(100% - 40px)":"50%":"40px"),p=(v,$)=>"ProjectPlaces";return Q(()=>{de(),d.value=document.getElementsByClassName("nav-item")}),(v,$)=>{const T=z("router-link");return l(),n("div",ys,[e("nav",null,[e("div",gs,[t(b).is_superuser?(l(),n("div",{key:0,class:"part part1",style:K({height:t(S)})},[e("div",{onClick:$[0]||($[0]=h=>o.value=!o.value),class:"header pointer"},[bs,e("i",{style:{top:"1px"},class:A("pi pi-angle-"+(o.value?"up":"down"))},null,2)]),c(N,{name:"slideDown"},{default:g(()=>[o.value?(l(),n("div",Bs,[(l(!0),n(L,null,O(t(B),h=>(l(),H(T,{key:h.id,to:{name:"SalonProjects",params:{cid:t(F).params.cid,dynid:h.id}},class:"nav-item flex align-center","active-class":"active"},{default:g(()=>[e("span",{class:"color block",style:K({backgroundColor:t(s)(h.id)})},null,4),e("div",null,j(h.name),1)]),_:2},1032,["to"]))),128))])):y("",!0)]),_:1})],4)):y("",!0),e("div",{class:"part part2",style:K({height:t(m)})},[e("div",{onClick:$[1]||($[1]=h=>u.value=!u.value),class:"header pointer"},[Cs,e("i",{style:{top:"1px"},class:A("pi pi-angle-"+(u.value?"up":"down"))},null,2)]),c(N,{name:"slideDown"},{default:g(()=>[u.value?(l(),n("div",xs,[(l(!0),n(L,null,O(t(C),h=>(l(),H(T,{key:h.id,to:{name:p(h.id,t(F).name+""),params:{cid:t(F).params.cid,dynid:h.id}},class:"p-nav-item nav-item flex align-center","active-class":"active"},{default:g(()=>[e("span",{class:"color block",style:K({backgroundColor:t(s)(h.id)})},null,4),e("div",null,j(h.name.replaceAll("<br>","")),1)]),_:2},1032,["to"]))),128))])):y("",!0)]),_:1})],4)])])])}}});const $s={class:"notify-top-bar flex align-center relative"},ks=e("div",{class:"icon flex align-center"},"\u{1F4CB}",-1),Es={class:"content"},js={class:"title"},Ds=e("i",{class:"pi pi-times"},null,-1),As=[Ds],Vs=U({props:{modelValue:Boolean,title:{type:String,default:"\u30A2\u30C3\u30D7\u30FC\u30C7\u30FC\u30C8"}},setup(V){const{notifyTopBar:b}=P(),B=()=>{b.value=!1};return(C,x)=>(l(),n("div",$s,[ks,e("div",Es,[e("h3",js,j(V.title),1),pe(C.$slots,"default")]),e("button",{class:"close",onClick:x[0]||(x[0]=_=>B())},As)]))}}),Ts={class:"mrw"},Us={class:"context"},Ps=E(" \u30EA\u30A2\u30AF\u30C4\u30FC\u30EB\u306E\u65B0\u3057\u3044\u30D0\u30FC\u30B8\u30E7\u30F3\u3092\u3054\u5229\u7528\u3044\u305F\u3060\u3051\u307E\u3059\u3002\u3088\u308A\u30D1\u30EF\u30D5\u30EB\u3067\u9AD8\u901F\u306B\u306A\u308A\u3001\u5B89\u5168\u6027\u3084\u4F7F\u3044\u3084\u3059\u3055\u3092\u5411\u4E0A\u3057\u3066\u3044\u307E\u3059\u3002"),Ss=e("br",null,null,-1),qs=E(" \u30D7\u30ED\u30B8\u30A7\u30AF\u30C8\u3054\u3068\u306B\u3044\u3064\u3067\u3082\u65B0\u30D0\u30FC\u30B8\u30E7\u30F3\uFF08v1.5\uFF09\u306B\u5207\u308A\u66FF\u3048\u308B\u4E8B\u304C\u3067\u304D\u307E\u3059\u3002 "),Ms=E("\u30C4\u30FC\u30C8\u30FC\u30EA\u30A2\u30EB\u3092\u898B\u308B\uFF01"),Ns={class:"column-1 flex"},et=U({setup(V){const{notifyTopBar:b,user:B}=P();return(C,x)=>{const _=z("router-link"),s=z("router-view");return l(),n("div",Ts,[t(b)?(l(),H(Vs,{key:0},{default:g(()=>[e("p",Us,[Ps,Ss,qs,c(_,{to:{name:"BoardTutorials",params:{cid:t(B).company}}},{default:g(()=>[Ms]),_:1},8,["to"])])]),_:1})):y("",!0),c(ws,{class:"bar-board container flex align-center"}),e("main",{class:A(["flex column-1",{"notify-on":t(b)}])},[e("div",Ns,[c(Fs),c(s,{class:"contents column-1"},{default:g(({Component:r})=>[c(N,{name:"fade",mode:"out-in"},{default:g(()=>[(l(),H(_e(r)))]),_:2},1024)]),_:1})])],2)])}}});export{et as default};
