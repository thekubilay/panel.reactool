import{d as H}from"./vuedraggable.umd.js";import{d as N,D as m,o as T,F as M,b as O,k as u,u as l,l as p,w as v,e as o,a3 as J,I as Q,J as z,a as G,U as F,t as b}from"./vendor.js";import{s as K}from"./menu.esm.js";import{a as L,u as W,S as X,_ as Y}from"./useFormRequestBuilder.js";import{_ as Z}from"./BarTool.js";import{_ as ee}from"./FormQuery.js";import{_ as te}from"./DialogDelete.js";import{b as se,A as le,u as oe}from"../main.js";import{u as ae}from"./useRightClickHandler.js";import"./overlayeventbus.esm.js";const ue=[[{classes:["flex","justify-space-between"],elements:[{component:null,name:"InputText",db_column_name:"name",type:"text",model:null,label:"\u30D5\u30A9\u30EB\u30C0\u30FC\u540D",hint:null,placeholder:"\u9593\u53D6\u308A\u56F3PDF\u30D5\u30A9\u30EB\u30C0\u30FC",required:!0,id:"name_input",rules:[],disabled:!se().user.is_staff,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]}]];const ne={id:"project_folders",class:"panel-board relative"},re={class:"part-wrap"},de={class:"part-wrap part-end"},ie={class:"spreadsheet-wrapper overflow-x"},ce=J('<div class="sh-container ss-container"><div class="sheet-row sheet-row-header flex align-center"><div class="sheet-cell handle flex align-center"></div><div class="sheet-cell num flex align-center">\u9806\u756A</div><div class="sheet-cell value flex align-center">\u30D5\u30A9\u30EB\u30C0\u30FC\u540D</div><div class="sheet-cell value flex align-center">\u66F8\u985E\u6570</div></div></div>',1),pe=["onClick","onContextmenu"],me=o("div",{class:"sheet-cell handle flex align-center justify-center grab"},[o("i",{class:"pi pi-bars"})],-1),ve={class:"sheet-cell num flex align-center"},fe={class:"sheet-cell value flex align-center"},_e={class:"context block"},ge={class:"sheet-cell num flex align-center"},he={class:"context block"},be={class:"button-wrapper flex justify-end"},Re=N({setup(je){const y=Q(),j=z(),{get:f,save:D}=le(),{d:r,dr:n,images:B,data:i,useToggle:_}=L(),{submit:k,submitRowReorder:V,remove:C}=W(),{rcm:w,rcmOpened:A,isRCOn:E}=ae(i),{payload:Ce,project:a,progress:$,onload:xe,content:d}=oe(),c=m([]),g=m(!1),h=m(!1);T(()=>{var t;c.value=(t=a.value)==null?void 0:t.document_folders});function R(){y.push({name:"ProjectDocuments",params:{cid:j.params.cid,dynid:j.params.dynid}})}function q(){var t;g.value=!1,_({method:"post",endpoints:["app/document_folders","project_details/"+((t=a.value)==null?void 0:t.id)],state:"project"})}function S(t){var e;g.value=!0,A.value||(B.value=t.pin?[{image:t.pin}]:[],_({method:"patch",endpoints:["app/document_folders/"+t.id,"project_details/"+((e=a.value)==null?void 0:e.id)],state:"project"},t))}function U(){var t;h.value=!0,C("app/document_folders/"+((t=i.value)==null?void 0:t.id)).then(()=>{var e;f("project_details/"+((e=a.value)==null?void 0:e.id),"project").then(()=>{h.value=!1,n.value=!1,r.value=!1})})}const P=m([{label:"\u65B0\u898F\u30D5\u30A9\u30EB\u30C0\u30FC",command:()=>{var t;_({method:"post",endpoints:["app/document_folders","project_details/"+((t=a.value)==null?void 0:t.id)],state:"project"})}},{label:"\u884C\u3092\u8907\u88FD\u3059\u308B",command:()=>{var e;d.value=!0;const t={id:null,order_id:c.value?c.value.length+1:1,project:a.value?(e=a.value)==null?void 0:e.id:null,name:i.value.name,color:i.value.color,pin:null};D("app/document_folders",t).then(()=>{var s;f("project_details/"+((s=a.value)==null?void 0:s.id),"project").then(()=>{d.value=!1})})}},{label:"\u884C\u3092\u524A\u9664\u3059\u308B",command:()=>{var t;d.value=!0,C("app/document_folders/"+((t=i.value)==null?void 0:t.id)).then(()=>{var e;f("project_details/"+((e=a.value)==null?void 0:e.id),"project").then(()=>{d.value=!1})})}}]);return M(()=>a.value,t=>{c.value=t==null?void 0:t.document_folders}),(t,e)=>(G(),O("div",ne,[u(X,{modelValue:l(d),"onUpdate:modelValue":e[0]||(e[0]=s=>p(d)?d.value=s:null)},null,8,["modelValue"]),u(Z,{class:"justify-space-between"},{default:v(()=>[o("div",re,[u(l(F),{type:"button",class:"submit-button",icon:"pi pi-plus","icon-pos":"left",label:"\u65B0\u898F\u30D5\u30A9\u30EB\u30C0\u30FC",onClick:e[1]||(e[1]=s=>q())})]),o("div",de,[u(l(F),{onClick:e[2]||(e[2]=s=>R()),type:"button",class:"tool-button",label:"\u66F8\u985E\u4E00\u89A7\u3078"})])]),_:1}),o("div",ie,[ce,u(l(H),{tag:"div",onEnd:e[3]||(e[3]=s=>l(V)({value:c.value},{method:"post",endpoints:["app/document_folders","project_details/"+l(a).id],state:"project"})),list:c.value,class:"sb-container ss-container",handle:".handle","item-key":"id"},{item:v(({element:s,index:I})=>[o("div",{onClick:x=>S(s),onContextmenu:x=>l(E)(x,s),class:"sheet-row flex align-center list-group-item relative pointer","aria-haspopup":"true","aria-controls":"plan_rc_menu"},[u(l(K),{id:"rc_menu",ref_key:"rcm",ref:w,class:"rc has-final-action",model:P.value,popup:!0},null,8,["model"]),me,o("div",ve,b(I+1),1),o("div",fe,[o("span",_e,b(s.name),1)]),o("div",ge,[o("span",he,b(s.documents.length)+"\u500B",1)])],40,pe)]),_:1},8,["list"])]),u(Y,{modelValue:l(r),"onUpdate:modelValue":e[9]||(e[9]=s=>p(r)?r.value=s:null),title:"\u30D5\u30A9\u30EB\u30C0\u30FC\u30D5\u30A9\u30FC\u30E0"},{default:v(()=>[u(ee,{modelValue:l(r),"onUpdate:modelValue":e[4]||(e[4]=s=>p(r)?r.value=s:null),dr:l(n),"onUpdate:dr":e[5]||(e[5]=s=>p(n)?n.value=s:null),"close-after":"",topProgress:"",progress:l($),form:l(ue),data:l(i),loading:h.value,query:{project:l(a).id},remove:g.value,submit:l(k)},null,8,["modelValue","dr","progress","form","data","loading","query","remove","submit"]),u(te,{modelValue:l(n),"onUpdate:modelValue":e[8]||(e[8]=s=>p(n)?n.value=s:null)},{default:v(()=>[o("div",be,[o("button",{onClick:e[6]||(e[6]=s=>n.value=!1),class:"cancel"},"\u3044\u3044\u3048"),o("button",{onClick:e[7]||(e[7]=s=>U()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}});export{Re as default};
