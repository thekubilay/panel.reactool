import{D as v,j as ce,d as G,a as F,b as U,c as M,w as f,e as u,k as r,u as o,g as O,t as J,n as W,l as C,a3 as _e,o as ve,F as Y,U as Z,K as fe,L as he}from"./vendor.js";import{d as ee}from"./vuedraggable.umd.js";import be from"./dropdown.esm.js";import{s as le}from"./menu.esm.js";import{s as Ce,a as oe}from"./column.esm.js";import{u as te,a as ue,_ as H,S as ge}from"./useFormRequestBuilder.js";import{_ as Ee}from"./BarTool.js";import{_ as ae}from"./FormQuery.js";import{_ as xe}from"./ContextImagesThumbnailContainer.js";import{A as se,u as re}from"../main.js";import{u as ne}from"./useRightClickHandler.js";import{_ as ie}from"./DialogDelete.js";import{_ as je}from"./FormNested.js";import{_ as de}from"./Icon.js";import{u as Fe}from"./useUtils.js";import"./overlayeventbus.esm.js";import"./virtualscroller.esm.js";const K=[[{classes:["flex"],elements:[{component:null,name:"InputText",db_column_name:"name",type:"text",model:null,label:"\u30EB\u30FC\u30E0\u540D",hint:null,placeholder:"\u30EA\u30D3\u30F3\u30B0",required:!0,id:"name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"image",type:"text",model:null,label:"BASE\u753B\u50CF",hint:".jpeg, .png \u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!1,id:"room_image_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[],rule:null,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]}]],me=[[{classes:["flex","justify-space-between"],elements:[{component:null,name:"InputText",db_column_name:"name",type:"text",model:null,label:"PART\u540D",hint:null,placeholder:"\u5E8A",required:!0,id:"part_name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-2-space"]},{component:null,name:"InputNumber",db_column_name:"column_count",type:"text",model:4,label:"\u30AB\u30FC\u30C9\u6570",hint:"\u4E00\u884C\u306B\u4E26\u3073\u305F\u3044\u30AB\u30E9\u30FC\u30AB\u30FC\u30C9\u6570",placeholder:"4",required:!0,id:"column_count_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-2-space"]}]}]];function ye(){const{get:V,save:x}=se(),{submit:h,submitRowReorder:T,remove:g}=te(),{d:D,d2:m,dr:p,data:j,images:y,useToggle:B}=ue(),{rcm:k,rcmOpened:A,isRCOn:N}=ne(j),{payload:$,content:q,progress:w,project:n}=re(),d=v(!1),b=v(!1),E=v(null),c=v(K),R=v([]),S=v(null),_=v(),P=v([{icon:"pi pi-plus",label:"\u65B0\u898F\u30EB\u30FC\u30E0",command:()=>{var a,s;d.value=!1,E.value={project:((a=n.value)==null?void 0:a.id)||null},y.value=[],c.value=K,B({method:"post",endpoints:["app/color_simulator_rooms","project_details/"+((s=n.value)==null?void 0:s.id)],state:"project"})}},{icon:"pi pi-pencil",label:"\u30EB\u30FC\u30E0\u7DE8\u96C6",command:()=>{var a,s,I,L,X;d.value=!0,E.value={project:((a=n.value)==null?void 0:a.id)||null},c.value=K,y.value=((s=_.value)==null?void 0:s.image)?[{image:(I=_.value)==null?void 0:I.image}]:[],B({method:"patch",endpoints:["app/color_simulator_rooms/"+((L=_.value)==null?void 0:L.id),"project_details/"+((X=n.value)==null?void 0:X.id)],state:"project"},_.value)}},{icon:"pi pi-bars",label:"\u30EB\u30FC\u30E0\u4E26\u3073\u66FF\u3048",command:()=>{var a;d.value=!1,c.value=[[]],y.value=[],$.value={method:"post",endpoints:["app/color_simulator_rooms","project_details/"+((a=n.value)==null?void 0:a.id)],state:"project"},m.value=!0}},{icon:"pi pi-plus",label:"\u65B0\u898F\u30EB\u30FC\u30E0PART",command:()=>{var a,s;y.value=[],d.value=!1,E.value={color_simulator_room:(a=_.value)==null?void 0:a.id},c.value=me,$.value={method:"post",endpoints:["app/color_simulator_room_parts","project_details/"+((s=n.value)==null?void 0:s.id)],state:"project"},D.value=!0}}]),i=ce(()=>{var a,s;return((a=_.value)==null?void 0:a.room_parts.length)>1?"column-"+((s=_.value)==null?void 0:s.room_parts.length)+"-space":"column-2-space"});return{d:D,d2:m,data:j,dr:p,rm:d,reform:c,query:E,loading:b,images:y,column:i,content:q,project:n,dropdownItems:P,rcm:k,rooms:R,room:_,roomId:S,isRCOn:N,rowReorder:a=>{R.value=a.value},sro:()=>{var a;b.value=!0,$.value={method:"post",endpoints:["app/color_simulator_rooms","project_details/"+((a=n.value)==null?void 0:a.id)],state:"project"},h({reordered:R.value},null,"object").then(()=>{b.value=!1,m.value=!1})},open:a=>{var s,I;E.value={color_simulator_room:(s=_.value)==null?void 0:s.id},c.value=me,d.value=!0,B({method:"patch",endpoints:["app/color_simulator_room_parts/"+a.id,"project_details/"+((I=n.value)==null?void 0:I.id)],state:"project"},a)},removeItem:()=>{var s,I;b.value=!0;const a=((s=E.value)==null?void 0:s.hasOwnProperty("project"))?"app/color_simulator_rooms/":"app/color_simulator_room_parts/";g(a+((I=j.value)==null?void 0:I.id)).then(()=>{var L;p.value=!1,V("project_details/"+((L=n.value)==null?void 0:L.id),"project").then(()=>{D.value=!1,b.value=!1})})},removeImage:a=>{var s;b.value=!0,$.value={method:"patch",endpoints:["app/color_simulator_rooms/"+j.value.id,"project_details/"+((s=n.value)==null?void 0:s.id)],state:"project"},h({image:null,thumbnail:null},null,"object").then(()=>{b.value=!1,y.value=[]})},submit:h,submitRowReorder:T}}const pe=[[{classes:["flex","justify-space-between"],elements:[{component:null,name:"Dropdown",db_column_name:"option",type:"text",model:!1,label:"\u30AA\u30D7\u30B7\u30E7\u30F3",hint:null,required:!0,rules:[],id:"option_input",disabled:!1,options:[{name:"\u306F\u3044",value:!0},{name:"\u3044\u3044\u3048",value:!1}],optionLabel:"name",optionValue:"value",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]},{component:null,name:"Dropdown",db_column_name:"model_room",type:"text",model:!1,label:"\u30E2\u30C7\u30EB\u30EB\u30FC\u30E0",hint:null,required:!0,rules:[],id:"model_room_input",disabled:!1,options:[{name:"\u306F\u3044",value:!0},{name:"\u3044\u3044\u3048",value:!1}],optionLabel:"name",optionValue:"value",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]}]},{classes:["flex"],elements:[{component:null,name:"InputText",db_column_name:"color",type:"text",model:null,label:"\u30AB\u30E9\u30FC\u540D",hint:null,placeholder:"\u30FC",required:!0,id:"name_input",rules:[],disabled:!1,props:["placeholder","required","disabled"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"part_image",type:"text",model:null,label:"PART\u753B\u50CF",hint:".png \u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!1,id:"part_image_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[],rule:null,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"color_image",type:"text",model:null,label:"\u30AB\u30E9\u30FC\u753B\u50CF",hint:".png \u3068 .jpeg \u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!1,id:"color_image_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[],rule:null,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]}]];const Be={class:"room-part-items-wrapper"},Ae=_e('<div class="sheet-row sheet-row_header flex align-center"><div class="short handle sheet-cell sheet-cell-header flex align-center"></div><div class="short sheet-cell sheet-cell-header flex align-center">PART<br>\u753B\u50CF</div><div class="short sheet-cell sheet-cell-header flex align-center">\u30AB\u30E9\u30FC<br>\u753B\u50CF</div><div class="sheet-cell sheet-cell-header flex align-center">\u30AB\u30E9\u30FC</div><div class="short sheet-cell sheet-cell-header flex align-center">EXTRA</div><div class="short sheet-cell sheet-cell-header flex align-center">\u30E2\u30C7\u30EB</div></div>',1),we=["onClick","onContextmenu"],Ve=u("div",{class:"short sheet-cell handle grab flex align-center"},[u("i",{class:"pi pi-bars"})],-1),De={class:"short sheet-cell sheet-value-cell flex align-center"},ke={class:"short sheet-cell sheet-value-cell flex align-center"},$e={class:"sheet-cell sheet-value-cell flex align-center"},Ie={class:"block value"},Re={class:"short sheet-cell sheet-value-cell flex align-center"},qe={key:0,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#2ecc71"}},Ue={key:1,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#e74c3c"}},Te={class:"short sheet-cell sheet-value-cell flex align-center"},Se={key:0,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#2ecc71"}},Pe={key:1,class:"pi pi-circle-fill",style:{"font-size":"1rem",color:"#e74c3c"}},Le={class:"button-wrapper flex justify-end"},Ne=G({props:{color_simulator_room_part:{type:Number,default:0},partItems:{type:Array,default:[]}},setup(V){var i;const{get:x,save:h}=se(),{submit:T,submitRowReorder:g,remove:D}=te(),{d:m,dr:p,data:j,images:y,useToggle:B}=ue(),{findAndUpdateFormElement:k}=Fe(),{rcm:A,rcmOpened:N,isRCOn:$}=ne(j),{payload:q,content:w,progress:n,project:d}=re();v((i=d.value)==null?void 0:i.links);const b=v(!1),E=v(!1),c=v(pe);function R(){var l;c.value=k(pe,"option","model",!1),c.value=k(c.value,"model_room","model",!1),B({method:"post",endpoints:["app/color_simulator_room_part_items","project_details/"+((l=d.value)==null?void 0:l.id)],state:"project"})}function S(l){var e;b.value=!0,B({method:"patch",endpoints:["app/color_simulator_room_part_items/"+l.id,"project_details/"+((e=d.value)==null?void 0:e.id)],state:"project"},l)}function _(){var l;E.value=!0,D("app/color_simulator_room_part_items/"+((l=j.value)==null?void 0:l.id)).then(()=>{var e;p.value=!1,x("project_details/"+((e=d.value)==null?void 0:e.id),"project").then(()=>{m.value=!1,E.value=!1})})}const P=v([{icon:"pi pi-plus",label:"\u65B0\u898F\u30A2\u30A4\u30C6\u30E0",command:()=>{var l;B({method:"post",endpoints:["app/color_simulator_room_part_items","project_details/"+((l=d.value)==null?void 0:l.id)],state:"project"})}},{icon:"pi pi-trash",label:"\u884C\u3092\u524A\u9664\u3059\u308B",command:()=>{var l;w.value=!0,D("app/color_simulator_room_part_items/"+((l=j.value)==null?void 0:l.id)).then(()=>{var e;x("project_details/"+((e=d.value)==null?void 0:e.id),"project").then(()=>{w.value=!1})})}}]);return(l,e)=>(F(),U("div",Be,[Ae,V.partItems.length?(F(),M(o(ee),{key:0,tag:"div",onEnd:e[0]||(e[0]=t=>o(g)({value:V.partItems},{method:"post",endpoints:["app/color_simulator_room_part_items","project_details/"+o(d).id+"/"],state:"project"})),list:V.partItems,class:"sheet-row",handle:".handle","item-key":"id"},{item:f(({element:t,index:Q})=>[u("div",{class:"part-item-box flex align-center pointer",onClick:z=>S(t),onContextmenu:z=>o($)(z,t),"aria-haspopup":"true","aria-controls":"plan_rc_menu"},[r(o(le),{id:"rc_menu",ref_key:"rcm",ref:A,class:"rc has-final-action",model:P.value,popup:!0},null,8,["model"]),Ve,u("div",De,[t.part_image?(F(),M(de,{key:0,svg:"image"})):O("",!0)]),u("div",ke,[t.color_image?(F(),M(de,{key:0,svg:"image"})):O("",!0)]),u("div",$e,[u("span",Ie,J(t.color),1)]),u("div",Re,[t.option?(F(),U("i",qe)):(F(),U("i",Ue))]),u("div",Te,[t.model_room?(F(),U("i",Se)):(F(),U("i",Pe))])],40,we)]),_:1},8,["list"])):O("",!0),u("button",{onClick:e[1]||(e[1]=t=>R()),class:W(["create-item flex align-center justify-center",{mt:V.partItems.length===1}])},"\u65B0\u898F\u30A2\u30A4\u30C6\u30E0 ",2),r(H,{modelValue:o(m),"onUpdate:modelValue":e[7]||(e[7]=t=>C(m)?m.value=t:null),title:"\u30AB\u30E9\u30FC\u30A2\u30A4\u30C6\u30E0\u30D5\u30A9\u30FC\u30E0",overflow:""},{default:f(()=>[r(ae,{modelValue:o(m),"onUpdate:modelValue":e[2]||(e[2]=t=>C(m)?m.value=t:null),dr:o(p),"onUpdate:dr":e[3]||(e[3]=t=>C(p)?p.value=t:null),"close-after":"",form:c.value,data:o(j),query:{color_simulator_room_part:V.color_simulator_room_part},submit:o(T),remove:b.value},null,8,["modelValue","dr","form","data","query","submit","remove"]),r(ie,{modelValue:o(p),"onUpdate:modelValue":e[6]||(e[6]=t=>C(p)?p.value=t:null)},{default:f(()=>[u("div",Le,[u("button",{onClick:e[4]||(e[4]=t=>p.value=!1),class:"cancel"},"\u3044\u3044\u3048"),u("button",{onClick:e[5]||(e[5]=t=>_()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]))}});const Me={id:"project_color_simulator",class:"panel-board relative"},Oe={class:"part-wrap first flex"},ze={class:"header flex align-center"},He=u("div",{class:"handle flex align-center grab"},[u("i",{class:"pi pi-bars"})],-1),Ke={class:"title"},Qe={class:"button-wrapper flex justify-end"},Xe=["onUpdate:modelValue"],Ge={class:"action-wrapper flex align-center"},cl=G({setup(V){const{d:x,d2:h,data:T,dr:g,rm:D,reform:m,query:p,loading:j,images:y,column:B,content:k,project:A,dropdownItems:N,rcm:$,rooms:q,room:w,roomId:n,isRCOn:d,rowReorder:b,sro:E,open:c,removeItem:R,removeImage:S,submit:_,submitRowReorder:P}=ye();return ve(()=>{var i,l;q.value=((i=A.value)==null?void 0:i.color_simulator_rooms)||[],(l=A.value)==null||l.color_simulator_rooms.forEach((e,t)=>{t===0&&(n.value=e.id)})}),Y(()=>A.value,i=>{q.value=(i==null?void 0:i.color_simulator_rooms)||[],w.value=i==null?void 0:i.color_simulator_rooms.find((l,e)=>n.value===l.id)}),Y(()=>n.value,i=>{var l;w.value=(l=A.value)==null?void 0:l.color_simulator_rooms.find((e,t)=>i===e.id)}),(i,l)=>(F(),U("div",Me,[r(ge,{modelValue:o(k),"onUpdate:modelValue":l[0]||(l[0]=e=>C(k)?k.value=e:null)},null,8,["modelValue"]),r(Ee,{class:"justify-space-between"},{default:f(()=>[u("div",Oe,[r(o(be),{style:{"min-width":"120px"},modelValue:o(n),"onUpdate:modelValue":l[1]||(l[1]=e=>C(n)?n.value=e:null),options:o(A).color_simulator_rooms,optionLabel:"name",optionValue:"id",placeholder:"\u30EB\u30FC\u30E0\u9078\u629E"},null,8,["modelValue","options"]),r(o(Z),{type:"button",class:"submit-button icon-button",icon:"pi pi-list",onClick:o(d),"aria-haspopup":"true","aria-controls":"rc_menu"},null,8,["onClick"]),r(o(le),{id:"rc_menu",ref_key:"rcm",ref:$,class:"rc",model:o(N),popup:!0},null,8,["model"])])]),_:1}),o(w)?(F(),M(o(ee),{key:0,tag:"div",onEnd:l[2]||(l[2]=e=>o(P)({value:o(w).room_parts},{method:"post",endpoints:["app/color_simulator_room_parts","project_details/"+o(A).id],state:"project"})),list:o(w).room_parts,class:"room-parts-wrapper flex justify-space-between",handle:".handle","item-key":"id"},{item:f(({element:e,index:t})=>[u("div",{class:W(["room-part-container",[o(B)]])},[u("div",ze,[He,u("div",Ke,J(e.name),1),r(o(Z),{onClick:Q=>o(c)(e),type:"button",class:"edit",icon:"pi pi-pencil","icon-pos":"left","aria-haspopup":"true"},null,8,["onClick"])]),r(Ne,{color_simulator_room_part:e.id,partItems:e.room_part_items},null,8,["color_simulator_room_part","partItems"])],2)]),_:1},8,["list"])):O("",!0),r(H,{modelValue:o(x),"onUpdate:modelValue":l[8]||(l[8]=e=>C(x)?x.value=e:null),title:"\u30EB\u30FC\u30E0\u30D5\u30A9\u30FC\u30E0"},{default:f(()=>[r(ae,{modelValue:o(x),"onUpdate:modelValue":l[3]||(l[3]=e=>C(x)?x.value=e:null),dr:o(g),"onUpdate:dr":l[4]||(l[4]=e=>C(g)?g.value=e:null),"close-after":"",form:o(m),data:o(T),remove:o(D),query:o(p),submit:o(_)},{default:f(()=>[r(xe,{containerId:"room_image_input",images:o(y),remove:o(S)},null,8,["images","remove"])]),_:1},8,["modelValue","dr","form","data","remove","query","submit"]),r(ie,{modelValue:o(g),"onUpdate:modelValue":l[7]||(l[7]=e=>C(g)?g.value=e:null)},{default:f(()=>[u("div",Qe,[u("button",{onClick:l[5]||(l[5]=e=>g.value=!1),class:"cancel"},"\u3044\u3044\u3048"),u("button",{onClick:l[6]||(l[6]=e=>o(R)()),class:"delete"},"\u306F\u3044")])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),r(H,{modelValue:o(h),"onUpdate:modelValue":l[12]||(l[12]=e=>C(h)?h.value=e:null),title:"\u30EB\u30FC\u30E0\u9806\u756A"},{default:f(()=>[r(je,{modelValue:o(h),"onUpdate:modelValue":l[11]||(l[11]=e=>C(h)?h.value=e:null),"close-after":"",form:o(m)},{actions:f(()=>[u("div",Ge,[u("button",{onClick:l[9]||(l[9]=e=>h.value=!1),class:"flex align-center justify-center cancel"},"\u4E2D\u6B62"),u("button",{onClick:l[10]||(l[10]=e=>o(E)()),class:"flex align-center justify-center submit-or-next"},"\u767B\u9332 ")])]),default:f(()=>[r(o(Ce),{value:o(q),rowindex:"index",onRowReorder:o(b),responsiveLayout:"scroll",class:"option-datatable"},{default:f(()=>[r(o(oe),{rowReorder:!0,headerStyle:"width: 3rem",reorderableColumn:!1}),r(o(oe),{field:"name",header:"\u30EB\u30FC\u30E0\u540D"},{body:f(e=>[fe(u("input",{class:"option-input",type:"text","onUpdate:modelValue":t=>e.data.name=t,placeholder:"\u9078\u629E\u9805\u76EE"},null,8,Xe),[[he,e.data.name]])]),_:1})]),_:1},8,["value","onRowReorder"])]),_:1},8,["modelValue","form"])]),_:1},8,["modelValue"])]))}});export{cl as default};
