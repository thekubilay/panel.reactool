import{p as y,N as c,b as d,e as q,a as R,v as m,f as g,w as N,I as V,J as w,z as D,M as $,T as K,L as G,o as W,O as Y,t as I,H as Z,y as O,K as B,A as x,x as F,C as ee,Q as te,g as ne,B as ae}from"./vendor.js";import{_,a as re}from"../main.js";import{S as se}from"./useFormRequestBuilder.js";import{_ as oe}from"./plugin-vue_export-helper.js";function le(){const u=y([]),o=y(null);function t(e){return new Date(e).toISOString().substring(0,10)}function n(e,a){return e==="start_date"||e==="end_date"?t(a):a}return{reform:u,requery:o,setProps:e=>e.props.reduce((a,b)=>(a[b]=e[b],a),{}),setFormQueryValues:(e,a,b)=>new Promise(k=>{o.value=a,u.value=e.filter((S,T)=>T===b),e.forEach(S=>{S.forEach(T=>{T.elements.forEach(v=>{o.value[v.db_column_name]=n(v.db_column_name,v.model)})})}),k(!0)})}}function ie(){return{setFormDefaultData:(t,n)=>{n&&t.forEach(s=>{s.forEach(l=>{l.elements.forEach(e=>{e.name==="Dropdown"&&typeof e.model=="boolean"?e.model=n[e.db_column_name]:e.name==="Dropdown"&&typeof e.model!="boolean"?n[e.db_column_name]?e.model=n[e.db_column_name]:e.model=null:e.name==="InputNumber"||e.name==="SliderInput"?e.model=n[e.db_column_name]?parseInt(n[e.db_column_name]):null:e.name==="FileInput"||(e.model=n[e.db_column_name])})})})},setClear:t=>(t.forEach(n=>{n.forEach(s=>{s.elements.forEach(l=>{l.name==="Dropdown"&&typeof l.model=="boolean"?l.db_column_name==="sub"?l.model=!1:l.model=!0:l.name==="Dropdown"&&typeof l.model!="boolean"||l.name!=="Dropdown"&&(l.model=null)})})}),t)}}function de(){return{setDynamics:o=>{let t=0;return new Promise((n,s)=>{o[0].length?o[0].forEach(l=>{l.elements.forEach(e=>{e.name==="InputText"&&_(()=>import("./vendor.js").then(function(a){return a.am}),[]).then(a=>{e.component=c(a.default)}),e.name==="InputNumber"&&_(()=>import("./vendor.js").then(function(a){return a.an}),[]).then(a=>{e.component=c(a.default)}),e.name==="Dropdown"&&_(()=>import("./dropdown.esm.js"),["chunks/dropdown.esm.js","chunks/vendor.js","chunks/overlayeventbus.esm.js","chunks/virtualscroller.esm.js"]).then(a=>{e.component=c(a.default)}),e.name==="MultiSelect"&&_(()=>import("./multiselect.esm.js"),["chunks/multiselect.esm.js","chunks/vendor.js","chunks/overlayeventbus.esm.js","chunks/virtualscroller.esm.js"]).then(a=>{e.component=c(a.default)}),e.name==="Checkbox"&&_(()=>import("./checkbox.esm.js"),["chunks/checkbox.esm.js","chunks/vendor.js"]).then(a=>{e.component=c(a.default)}),e.name==="Password"&&_(()=>import("./password.esm.js"),["chunks/password.esm.js","chunks/vendor.js","chunks/overlayeventbus.esm.js"]).then(a=>{e.component=c(a.default)}),e.name==="Textarea"&&_(()=>import("./textarea.esm.js"),["chunks/textarea.esm.js","chunks/vendor.js"]).then(a=>{e.component=c(a.default)}),e.name==="RadioButton"&&_(()=>import("./radiobutton.esm.js"),["chunks/radiobutton.esm.js","chunks/vendor.js"]).then(a=>{e.component=c(a.default)}),e.name==="FileInput"&&_(()=>import("./FileInput.js"),["chunks/FileInput.js","assets/FileInput.css","chunks/Icon.js","main.js","assets/main2.css","chunks/vendor.js"]).then(a=>{e.component=c(a.default)}),e.name==="SliderInput"&&_(()=>import("./slider.esm.js"),["chunks/slider.esm.js","chunks/vendor.js"]).then(a=>{e.component=c(a.default)}),e.name==="CalendarInput"&&_(()=>import("./calendar.esm.js"),["chunks/calendar.esm.js","chunks/vendor.js","chunks/overlayeventbus.esm.js"]).then(a=>{e.component=c(a.default)})}),t+=1,t===o.length&&n(!0)}):n(!0)})}}}function ue(){return{isElementValid:t=>{let n={valid:!0,errors:[]};return t.model&&t.required&&(t.rules.forEach(s=>{n.errors.push(s(t.model))}),n.errors=n.errors.filter(s=>s!==""),n.errors=[...new Set(n.errors)]),n.valid=!t.required||t.model!==""||typeof t.model=="number",n},isFormValid:t=>{let n=[];return t.forEach(s=>{s.forEach(l=>{l.elements.forEach(e=>{if(e.required&&!e.model&&typeof e.model!="boolean"&&e.id){const a=document.getElementById(e.id);a.classList.add("error"),n.push(a)}})})}),!n.length}}}var L={name:"Skeleton",props:{shape:{type:String,default:"rectangle"},size:{type:String,default:null},width:{type:String,default:"100%"},height:{type:String,default:"1rem"},borderRadius:{type:String,default:null},animation:{type:String,default:"wave"}},computed:{containerClass(){return["p-skeleton p-component",{"p-skeleton-circle":this.shape==="circle","p-skeleton-none":this.animation==="none"}]},containerStyle(){return this.size?{width:this.size,height:this.size,borderRadius:this.borderRadius}:{width:this.width,height:this.height,borderRadius:this.borderRadius}}}};function fe(u,o,t,n,s,l){return d(),q("div",{style:l.containerStyle,class:l.containerClass},null,6)}function me(u,o){o===void 0&&(o={});var t=o.insertAt;if(!(!u||typeof document=="undefined")){var n=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",t==="top"&&n.firstChild?n.insertBefore(s,n.firstChild):n.appendChild(s),s.styleSheet?s.styleSheet.cssText=u:s.appendChild(document.createTextNode(u))}}var pe=`
.p-skeleton {
    position: relative;
    overflow: hidden;
}
.p-skeleton::after {
    content: "";
    -webkit-animation: p-skeleton-animation 1.2s infinite;
            animation: p-skeleton-animation 1.2s infinite;
    height: 100%;
    left: 0;
    position: absolute;
    right: 0;
    top: 0;
    -webkit-transform: translateX(-100%);
            transform: translateX(-100%);
    z-index: 1;
}
.p-skeleton.p-skeleton-circle {
    border-radius: 50%;
}
.p-skeleton-none::after {
   -webkit-animation: none;
           animation: none;
}
@-webkit-keyframes p-skeleton-animation {
from {
        -webkit-transform: translateX(-100%);
                transform: translateX(-100%);
}
to {
        -webkit-transform: translateX(100%);
                transform: translateX(100%);
}
}
@keyframes p-skeleton-animation {
from {
        -webkit-transform: translateX(-100%);
                transform: translateX(-100%);
}
to {
        -webkit-transform: translateX(100%);
                transform: translateX(100%);
}
}
`;me(pe);L.render=fe;const ce={class:"skeleton-wrapper"},_e={key:0,class:"skeleton-window absolute"},ve=R({props:{modelValue:Boolean},setup(u){const o=y("fade"),t=y(2);return(n,s)=>(d(),m("div",ce,[g(K,{name:o.value},{default:N(()=>[u.modelValue?$(n.$slots,"default",{key:1},void 0,!0):(d(),m("div",_e,[(d(!0),m(V,null,w(t.value,l=>(d(),m("div",{key:l,class:"skeleton-scaffold"},[g(D(L),{height:"19px",width:"100px",class:"skeleton"}),g(D(L),{height:"36px",width:"100%",class:"skeleton"})]))),128))]))]),_:3},8,["name"])]))}});var he=oe(ve,[["__scopeId","data-v-125e0694"]]);const ye=R({props:{modelValue:Number},setup(u){return(o,t)=>(d(),m("div",{class:"top-edge-progress",style:G({width:u.modelValue+"%"})},null,4))}}),be={ref:"container",id:"form"},ke={key:0,class:"tabs flex align-center"},Ee=["onClick"],ge=["onSubmit"],Ve={key:0,class:"label title-label"},we={class:"label flex"},De={key:0,class:"required flex align-start"},Ie={key:1,class:"hint"},xe={class:"action-wrapper flex align-center"},Be=R({props:{modelValue:Boolean,display:Boolean,dr:Boolean,remove:Boolean,selectedId:Number,activeTab:{type:Number,default:0},form:{type:Array,default:[]},data:Object,loading:{type:Boolean,default:!1},progress:Number,onload:{type:String,default:""},query:Object,nestedQuery:Object,closeAfter:Boolean,tabs:{type:Array,default:[]},submit:Function},emits:["update:modelValue","update:dr","update:response","update:payload","update:activeTab","update:form"],setup(u,{emit:o}){const t=u;re();const{setDynamics:n}=de(),{setFormDefaultData:s,setClear:l}=ie(),{reform:e,requery:a,setProps:b,setFormQueryValues:k}=le(),{isElementValid:S,isFormValid:T}=ue(),v=y(!1),E=y(!1),h=y(0);W(()=>{h.value=t.activeTab,document.addEventListener("keydown",P),t.activeTab===0&&k(t.form,t.query,h.value).then(()=>{n(e.value.filter((r,i)=>i===h.value)).then(r=>{s(e.value,t.data),E.value=r})})}),Y(()=>{document.removeEventListener("keydown",P),l(e.value)});const X=r=>{h.value=r,t.tabs&&o("update:activeTab",r)},z=r=>{v.value=!1,r&&o("update:response",r),t.closeAfter&&setTimeout(()=>{o("update:modelValue",!1)},300)},U=()=>{e.value.forEach(r=>{r.forEach(i=>{i.elements.forEach(f=>{f.model=f.name!=="FileInput"?f.model:null})})})},Q=()=>{o("update:dr",!0)},P=(r,i=!1)=>{(i||r.keyCode===13)&&(document.getElementById("tpb").style.opacity="1",r.preventDefault(),v.value=!0,T(e.value)?t.submit(a.value,e.value).then(f=>{U(),z(f)}):v.value=!1)};return I(()=>t.query,r=>{k(t.form,r,h.value)}),I(()=>t.loading,r=>{v.value=r}),I(()=>t.activeTab,r=>{h.value=r}),I(()=>t.data,r=>{s(e.value,r)}),I(()=>t.form,r=>{e.value=r,k(e.value,t.query,h.value).then(()=>{n(e.value.filter((i,f)=>f===h.value)).then(i=>{E.value=i})})}),I(()=>h.value,r=>{E.value=!1,k(t.form,t.query,r).then(()=>{n(e.value).then(i=>{s(e.value,t.data),E.value=i})})}),(r,i)=>(d(),m("div",be,[g(se,{modelValue:v.value,"onUpdate:modelValue":i[0]||(i[0]=f=>v.value=f),text:u.onload?u.onload:null},null,8,["modelValue","text"]),g(ye,{id:"tpb",modelValue:u.progress,"onUpdate:modelValue":i[1]||(i[1]=f=>Z(progress)?progress.value=f:null)},null,8,["modelValue"]),u.tabs.length?(d(),m("div",ke,[(d(!0),m(V,null,w(u.tabs,(f,C)=>(d(),m("button",{key:C,onClick:j=>X(C),class:O([{active:C===h.value},"tab flex align-center justify-center"])},B(f),11,Ee))),128))])):x("",!0),g(he,{modelValue:E.value,"onUpdate:modelValue":i[5]||(i[5]=f=>E.value=f)},{default:N(()=>[F("form",{action:"",onSubmit:ae(f=>!1,["prevent"])},[(d(!0),m(V,null,w(D(e),(f,C)=>(d(),m("div",{key:C},[(d(!0),m(V,null,w(f,(j,M)=>(d(),m("div",{key:M,class:O(["row",j.classes])},[j.elements[0].hasOwnProperty("title")?(d(),m("span",Ve,B(j.elements[0].title),1)):x("",!0),(d(!0),m(V,null,w(j.elements,(p,H)=>(d(),m("div",{key:H,class:O(p.classes)},[F("span",we,[ee(B(p.label),1),p.required?(d(),m("span",De,"*\u5FC5\u9808")):x("",!0)]),p.component?(d(),q(ne(p.component),te({key:0,id:p.id},D(b)(p),{modelValue:p.model,"onUpdate:modelValue":A=>p.model=A,class:["cfec column-1",{error:!D(S)(p).valid}]}),null,16,["id","modelValue","onUpdate:modelValue","class"])):x("",!0),(d(!0),m(V,null,w(D(S)(p).errors,(A,J)=>(d(),m("span",{key:J,class:"invalid block"},"*"+B(A),1))),128)),p.hint&&p.name!=="FileInput"?(d(),m("span",Ie,B(p.hint),1)):x("",!0)],2))),128))],2))),128)),$(r.$slots,"default")]))),128)),F("div",xe,[F("button",{onClick:i[2]||(i[2]=f=>o("update:modelValue",!1)),class:"flex align-center justify-center cancel"},"\u4E2D\u6B62"),u.remove?(d(),m("button",{key:0,onClick:i[3]||(i[3]=f=>Q()),class:"flex align-center justify-center remove"},"\u524A\u9664 ")):x("",!0),F("button",{onClick:i[4]||(i[4]=f=>P(f,!0)),class:"flex align-center justify-center submit-or-next"},"\u767B\u9332 ")])],40,ge)]),_:3},8,["modelValue"])],512))}});export{he as D,Be as _,ye as a,de as b,ie as c,ue as d,le as u};
