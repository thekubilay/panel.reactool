import{D as T}from"./vuedraggable.umd.js";import{d as S,A as U,u as L,l as d,m as H,D as E,c as I,g as n,b as a,p as v,w as f,h as t,P as M,o as N,s as x,t as g}from"../main.js";import{s as G}from"./menu.esm.js";import{s as z}from"./dropdown.esm.js";import{_ as O}from"./Dialog.js";import{S as J}from"./Spinner.js";import{_ as K}from"./BarTool.js";import{_ as Q}from"./Icon.js";import{a as W,u as X}from"./useFormRequestBuilder.js";import{u as Y}from"./useRightClickHandler.js";import{_ as Z}from"./FormQuery.js";import{c as ee,d as le}from"./rules.js";import{u as ue}from"./useUtils.js";import"./_commonjsHelpers.js";import"./portal.esm.js";import"./index.esm.js";import"./virtualscroller.esm.js";import"./plugin-vue_export-helper.js";const h=[[{classes:["flex"],elements:[{component:null,name:"Dropdown",db_column_name:"kind",type:"text",model:"\u6577\u5730\u914D\u7F6E\u56F3",label:"\u4E00\u822C\u56F3\u7A2E\u985E",hint:null,required:!0,rules:[],id:"kind_input",disabled:!1,options:[{name:"\u6577\u5730\u914D\u7F6E\u56F3",value:"\u6577\u5730\u914D\u7F6E\u56F3"},{name:"\u7ACB\u9762\u56F3",value:"\u7ACB\u9762\u56F3"},{name:"\u5404\u968E\u5E73\u9762\u56F3",value:"\u5404\u968E\u5E73\u9762\u56F3"}],optionLabel:"name",optionValue:"value",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]}]},{classes:["flex"],elements:[{component:null,name:"Textarea",db_column_name:"html_code",type:"text",model:null,label:"Html",hint:"\u3053\u3053\u306B\u5165\u529B\u3057\u305F\u5185\u5BB9\u306F\u30A2\u30D7\u30EA\u306B\u306F\u8868\u793A\u3055\u308C\u307E\u305B\u3093\u3002",placeholder:"html",required:!1,autoResize:!1,rows:"40",cols:"30",id:"context_input",rules:[],disabled:!1,props:["placeholder","required","disabled","autoResize"],classes:["flex-column","column-1"]}]},{classes:["flex"],elements:[{component:null,name:"FileInput",db_column_name:"image",type:"text",model:null,label:"\u753B\u50CF",hint:".jpeg, .png \u304C\u30B5\u30DD\u30FC\u30C8\u3055\u308C\u3066\u3044\u307E\u3059",required:!1,id:"general_plan_input",preview_text:"\u30A2\u30C3\u30D7\u30ED\u30FC\u30C9\u306E\u305F\u3081\u3001\u30AF\u30EA\u30C3\u30AF\u3084\u753B\u50CF\u30C9\u30ED\u30C3\u30D7\u3057\u3066\u304F\u3060\u3055\u3044",limit:"1MB\u4EE5\u4E0B",accept:"image/*",rules:[ee],rule:le,disabled:!1,props:["placeholder","required","disabled","accept","hint","model","image_path","preview_text","limit","rule"],classes:["flex-column","column-1"]}]}]],ae=[[{classes:["flex"],elements:[{component:null,name:"Dropdown",db_column_name:"position",type:"text",model:0,label:"\u30BF\u30D6\u914D\u7F6E",hint:null,required:!0,rules:[],id:"position_input",disabled:!1,options:[{name:"\u4E0B\u30BB\u30F3\u30BF\u30FC",value:1},{name:"\u5DE6\u4E0A",value:2},{name:"\u53F3\u4E0A",value:3},{name:"\u4E0A\u30BB\u30F3\u30BF\u30FC",value:4}],optionLabel:"name",optionValue:"value",placeholder:"\u9078\u629E",appendTo:"body",props:["placeholder","required","disabled","options","optionLabel","optionValue","appendTo"],classes:["flex-column","column-2-space","relative"]}]}]];const te={id:"project_general_plans",class:"panel-board relative"},se={class:"part-wrap"},ne={class:"part-wrap part-end"},oe={class:"spreadsheet-wrapper overflow-x"},ie=M('<div class="sh-container ss-container"><div class="sheet-row sheet-row-header flex align-center"><div class="sheet-cell handle flex align-center"></div><div class="sheet-cell num flex align-center">\u9806\u756A</div><div class="sheet-cell img flex align-center"><i class="pi pi-file"></i></div><div class="sheet-cell value flex align-center">\u7A2E\u985E</div><div class="sheet-cell value flex align-center">HTML\u30B3\u30FC\u30C9</div></div></div>',1),re=["onContextmenu","onClick"],pe=t("div",{class:"sheet-cell handle flex align-center handle grab"},[t("i",{class:"pi pi-bars"})],-1),de={class:"sheet-cell num flex align-center"},ce={class:"text block"},me={class:"sheet-cell img flex align-center"},_e={class:"sheet-cell value flex align-center"},ve={class:"text block"},fe={class:"sheet-cell value flex align-center"},ge={class:"text block"},Ie=S({__name:"ProjectGeneralPlans",setup(he){const{get:C,save:Fe}=U(),{submit:B,submitRowReorder:D,remove:k}=W(),{d:i,dr:be,data:_,useToggle:c}=X(),{rcm:A,rcmOpened:Ee,isRCOn:w}=Y(_),{payload:xe,content:r,progress:V,project:s}=L(),{findAndUpdateFormElement:F}=ue(),m=d(h),o=d("\u6577\u5730\u914D\u7F6E\u56F3"),j=d(["\u6577\u5730\u914D\u7F6E\u56F3","\u7ACB\u9762\u56F3","\u5404\u968E\u5E73\u9762\u56F3"]),p=d([]),y=d([{label:"\u65B0\u898F\u30D7\u30E9\u30F3",command:()=>{var l;c({method:"post",endpoints:["app/general_plans","project_details/"+((l=s.value)==null?void 0:l.id)],state:"project"})}},{label:"\u884C\u3092\u524A\u9664\u3059\u308B",command:()=>{var l;r.value=!0,k("app/general_plans/"+((l=_.value)==null?void 0:l.id)).then(()=>{var e;C("project_details/"+((e=s.value)==null?void 0:e.id),"project").then(()=>{r.value=!1})})}}]);H(()=>{var l;p.value=((l=s.value)==null?void 0:l.general_plans.filter(e=>e.kind===o.value))||[]});function q(){var l;m.value=F(h,"kind","model",o.value),c({method:"post",endpoints:["app/general_plans","project_details/"+((l=s.value)==null?void 0:l.id)],state:"project"})}function $(l){var e;m.value=F(h,"kind","model",o.value),c({method:"patch",endpoints:["app/general_plans/"+l.id,"project_details/"+((e=s.value)==null?void 0:e.id)],state:"project"},l)}function R(l){var e;m.value=ae,c({method:"patch",endpoints:["app/general_plan_settings/"+l.id,"project_details/"+((e=s.value)==null?void 0:e.id)],state:"project"},l)}return E(()=>o.value,l=>{var e;p.value=((e=s.value)==null?void 0:e.general_plans.filter(u=>u.kind===l))||[]}),E(()=>s.value,l=>{p.value=(l==null?void 0:l.general_plans.filter(e=>e.kind===o.value))||[]}),(l,e)=>(N(),I("div",te,[n(J,{modelValue:a(r),"onUpdate:modelValue":e[0]||(e[0]=u=>v(r)?r.value=u:null)},null,8,["modelValue"]),n(K,{class:"justify-space-between"},{default:f(()=>[t("div",se,[n(a(x),{type:"button",class:"submit-button",icon:"pi pi-plus","icon-pos":"left",label:"\u30D7\u30E9\u30F3\u3092\u8FFD\u52A0",onClick:e[1]||(e[1]=u=>q())}),n(a(x),{type:"button",class:"submit-button icon-button",icon:"pi pi-cog","icon-pos":"left",onClick:e[2]||(e[2]=u=>R(a(s).general_plan_settings))})]),t("div",ne,[n(a(z),{style:{"margin-left":"0",width:"120px"},class:"dropdown",modelValue:o.value,"onUpdate:modelValue":e[3]||(e[3]=u=>o.value=u),options:j.value,placeholder:"\u30D5\u30A9\u30EB\u30C0\u30FC\u9078\u629E"},null,8,["modelValue","options"])])]),_:1}),t("div",oe,[ie,n(a(T),{tag:"div",onEnd:e[4]||(e[4]=u=>a(D)({value:p.value},{method:"post",endpoints:["app/general_plans","project_details/"+a(s).id],state:"project"})),list:p.value,class:"sb-container ss-container",handle:".handle","item-key":"id"},{item:f(({element:u,index:P})=>[t("div",{onContextmenu:b=>a(w)(b,u),onClick:b=>$(u),"aria-haspopup":"true","aria-controls":"plan_rc_menu",class:"sheet-row flex align-center list-group-item relative pointer"},[n(a(G),{id:"rc_menu",ref_key:"rcm",ref:A,class:"rc has-final-action",model:y.value,popup:!0},null,8,["model"]),pe,t("div",de,[t("span",ce,g(P+1),1)]),t("div",me,[n(Q,{svg:"image"})]),t("div",_e,[t("span",ve,g(u.kind),1)]),t("div",fe,[t("span",ge,g(u.html_code),1)])],40,re)]),_:1},8,["list"])]),n(O,{modelValue:a(i),"onUpdate:modelValue":e[6]||(e[6]=u=>v(i)?i.value=u:null),title:"\u4E00\u822C\u56F3\u30D5\u30A9\u30FC\u30E0",overflow:""},{default:f(()=>[n(Z,{modelValue:a(i),"onUpdate:modelValue":e[5]||(e[5]=u=>v(i)?i.value=u:null),"close-after":"",progress:a(V),form:m.value,data:a(_),query:{project:a(s).id},submit:a(B)},null,8,["modelValue","progress","form","data","query","submit"])]),_:1},8,["modelValue"])]))}});export{Ie as default};
